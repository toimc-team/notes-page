<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é… | å¤§å‰ç«¯ - å‰ç«¯é«˜çº§è¿›é˜¶</title>
    <meta name="generator" content="VuePress 1.9.9">
    <script>
      var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?8b87000f915d1fe37e079a25c2e12d6b";
        var s = document.getElementsByTagName("script")[0]; 
        s.parentNode.insertBefore(hm, s);
      })();
      </script>
    <meta name="description" content="å¤§å‰ç«¯è¯¾ç¨‹ç”µå­ä¹¦">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/notes-page/assets/css/0.styles.1de91c51.css" as="style"><link rel="preload" href="/notes-page/assets/js/app.13c7e4b8.js" as="script"><link rel="preload" href="/notes-page/assets/js/5.d4cdcacd.js" as="script"><link rel="preload" href="/notes-page/assets/js/45.93743a6b.js" as="script"><link rel="prefetch" href="/notes-page/assets/js/10.eb622954.js"><link rel="prefetch" href="/notes-page/assets/js/100.75ee6478.js"><link rel="prefetch" href="/notes-page/assets/js/101.021939a3.js"><link rel="prefetch" href="/notes-page/assets/js/102.62ed3f8e.js"><link rel="prefetch" href="/notes-page/assets/js/103.a9f2a1f2.js"><link rel="prefetch" href="/notes-page/assets/js/104.ba685614.js"><link rel="prefetch" href="/notes-page/assets/js/105.3fe43102.js"><link rel="prefetch" href="/notes-page/assets/js/106.f19c0167.js"><link rel="prefetch" href="/notes-page/assets/js/107.474f36f6.js"><link rel="prefetch" href="/notes-page/assets/js/108.e530a156.js"><link rel="prefetch" href="/notes-page/assets/js/109.5724dcb4.js"><link rel="prefetch" href="/notes-page/assets/js/11.88d6abb5.js"><link rel="prefetch" href="/notes-page/assets/js/110.ee6db8c5.js"><link rel="prefetch" href="/notes-page/assets/js/111.a42e6170.js"><link rel="prefetch" href="/notes-page/assets/js/112.02441deb.js"><link rel="prefetch" href="/notes-page/assets/js/113.1f432d8c.js"><link rel="prefetch" href="/notes-page/assets/js/114.3e991589.js"><link rel="prefetch" href="/notes-page/assets/js/115.4cf7fb12.js"><link rel="prefetch" href="/notes-page/assets/js/116.34224f90.js"><link rel="prefetch" href="/notes-page/assets/js/117.471aac90.js"><link rel="prefetch" href="/notes-page/assets/js/118.4262261a.js"><link rel="prefetch" href="/notes-page/assets/js/119.f031f49a.js"><link rel="prefetch" href="/notes-page/assets/js/12.ceda528f.js"><link rel="prefetch" href="/notes-page/assets/js/120.9519f618.js"><link rel="prefetch" href="/notes-page/assets/js/121.63c58b24.js"><link rel="prefetch" href="/notes-page/assets/js/122.bd5f6422.js"><link rel="prefetch" href="/notes-page/assets/js/123.c7a98556.js"><link rel="prefetch" href="/notes-page/assets/js/124.09490a1f.js"><link rel="prefetch" href="/notes-page/assets/js/125.2775b26d.js"><link rel="prefetch" href="/notes-page/assets/js/126.8a48b153.js"><link rel="prefetch" href="/notes-page/assets/js/127.dac2f049.js"><link rel="prefetch" href="/notes-page/assets/js/128.7d791e91.js"><link rel="prefetch" href="/notes-page/assets/js/129.8f1d6889.js"><link rel="prefetch" href="/notes-page/assets/js/13.ca8c7889.js"><link rel="prefetch" href="/notes-page/assets/js/130.aaf08f42.js"><link rel="prefetch" href="/notes-page/assets/js/131.d4326118.js"><link rel="prefetch" href="/notes-page/assets/js/132.e315dec4.js"><link rel="prefetch" href="/notes-page/assets/js/133.38323ffb.js"><link rel="prefetch" href="/notes-page/assets/js/134.8d2d670b.js"><link rel="prefetch" href="/notes-page/assets/js/135.665bb418.js"><link rel="prefetch" href="/notes-page/assets/js/136.3fda0f86.js"><link rel="prefetch" href="/notes-page/assets/js/137.6fbd5b98.js"><link rel="prefetch" href="/notes-page/assets/js/138.1f56f008.js"><link rel="prefetch" href="/notes-page/assets/js/139.cab9f4c4.js"><link rel="prefetch" href="/notes-page/assets/js/14.2ea2b952.js"><link rel="prefetch" href="/notes-page/assets/js/140.dc9d4212.js"><link rel="prefetch" href="/notes-page/assets/js/141.b438d441.js"><link rel="prefetch" href="/notes-page/assets/js/142.d1583448.js"><link rel="prefetch" href="/notes-page/assets/js/143.22afea89.js"><link rel="prefetch" href="/notes-page/assets/js/144.70b95a45.js"><link rel="prefetch" href="/notes-page/assets/js/145.0f4eb1b5.js"><link rel="prefetch" href="/notes-page/assets/js/146.8b9f434b.js"><link rel="prefetch" href="/notes-page/assets/js/147.08848f46.js"><link rel="prefetch" href="/notes-page/assets/js/148.40d559e6.js"><link rel="prefetch" href="/notes-page/assets/js/149.6f9a5c30.js"><link rel="prefetch" href="/notes-page/assets/js/15.82e23785.js"><link rel="prefetch" href="/notes-page/assets/js/150.0aa40c5e.js"><link rel="prefetch" href="/notes-page/assets/js/151.5789b53a.js"><link rel="prefetch" href="/notes-page/assets/js/152.7cb95551.js"><link rel="prefetch" href="/notes-page/assets/js/153.acef87a0.js"><link rel="prefetch" href="/notes-page/assets/js/154.c8dd5f12.js"><link rel="prefetch" href="/notes-page/assets/js/155.145baaea.js"><link rel="prefetch" href="/notes-page/assets/js/156.c2839c3b.js"><link rel="prefetch" href="/notes-page/assets/js/157.b446ee8d.js"><link rel="prefetch" href="/notes-page/assets/js/158.60375fdb.js"><link rel="prefetch" href="/notes-page/assets/js/159.c041a087.js"><link rel="prefetch" href="/notes-page/assets/js/16.8b60908f.js"><link rel="prefetch" href="/notes-page/assets/js/160.26dfb22e.js"><link rel="prefetch" href="/notes-page/assets/js/161.12700ff9.js"><link rel="prefetch" href="/notes-page/assets/js/162.8d55eed0.js"><link rel="prefetch" href="/notes-page/assets/js/163.f252d444.js"><link rel="prefetch" href="/notes-page/assets/js/164.bb5d494c.js"><link rel="prefetch" href="/notes-page/assets/js/165.5276895f.js"><link rel="prefetch" href="/notes-page/assets/js/166.8b3cfc84.js"><link rel="prefetch" href="/notes-page/assets/js/167.851a5125.js"><link rel="prefetch" href="/notes-page/assets/js/168.cac8f63e.js"><link rel="prefetch" href="/notes-page/assets/js/169.a81501cb.js"><link rel="prefetch" href="/notes-page/assets/js/17.1152ce26.js"><link rel="prefetch" href="/notes-page/assets/js/170.8a99c248.js"><link rel="prefetch" href="/notes-page/assets/js/171.e702b99d.js"><link rel="prefetch" href="/notes-page/assets/js/172.26132b65.js"><link rel="prefetch" href="/notes-page/assets/js/173.40d2f4fa.js"><link rel="prefetch" href="/notes-page/assets/js/174.d72f4447.js"><link rel="prefetch" href="/notes-page/assets/js/175.dab9e140.js"><link rel="prefetch" href="/notes-page/assets/js/176.1bd34add.js"><link rel="prefetch" href="/notes-page/assets/js/177.1b20235f.js"><link rel="prefetch" href="/notes-page/assets/js/178.2993808e.js"><link rel="prefetch" href="/notes-page/assets/js/179.27ae43d9.js"><link rel="prefetch" href="/notes-page/assets/js/18.5d5f0865.js"><link rel="prefetch" href="/notes-page/assets/js/180.a62294e7.js"><link rel="prefetch" href="/notes-page/assets/js/181.74a6d5e2.js"><link rel="prefetch" href="/notes-page/assets/js/182.03c68b53.js"><link rel="prefetch" href="/notes-page/assets/js/183.1ae2ec8f.js"><link rel="prefetch" href="/notes-page/assets/js/184.593ac06d.js"><link rel="prefetch" href="/notes-page/assets/js/185.3c75407f.js"><link rel="prefetch" href="/notes-page/assets/js/19.be3de5b7.js"><link rel="prefetch" href="/notes-page/assets/js/20.ab5f3abd.js"><link rel="prefetch" href="/notes-page/assets/js/21.6bb5f501.js"><link rel="prefetch" href="/notes-page/assets/js/22.344d0aa6.js"><link rel="prefetch" href="/notes-page/assets/js/23.cbe889e8.js"><link rel="prefetch" href="/notes-page/assets/js/24.0f3d5570.js"><link rel="prefetch" href="/notes-page/assets/js/25.2d35d2c9.js"><link rel="prefetch" href="/notes-page/assets/js/26.a7e73613.js"><link rel="prefetch" href="/notes-page/assets/js/27.f89c2e59.js"><link rel="prefetch" href="/notes-page/assets/js/28.4ef169a4.js"><link rel="prefetch" href="/notes-page/assets/js/29.0470929a.js"><link rel="prefetch" href="/notes-page/assets/js/30.3ab4b4c0.js"><link rel="prefetch" href="/notes-page/assets/js/31.65baf7d0.js"><link rel="prefetch" href="/notes-page/assets/js/32.0c4ce4f3.js"><link rel="prefetch" href="/notes-page/assets/js/33.0266ccac.js"><link rel="prefetch" href="/notes-page/assets/js/34.949e5662.js"><link rel="prefetch" href="/notes-page/assets/js/35.9668cf40.js"><link rel="prefetch" href="/notes-page/assets/js/36.b69e67c8.js"><link rel="prefetch" href="/notes-page/assets/js/37.8a7a62c6.js"><link rel="prefetch" href="/notes-page/assets/js/38.4752cbc7.js"><link rel="prefetch" href="/notes-page/assets/js/39.97a16bc2.js"><link rel="prefetch" href="/notes-page/assets/js/40.643aeb70.js"><link rel="prefetch" href="/notes-page/assets/js/41.13727424.js"><link rel="prefetch" href="/notes-page/assets/js/42.0c3bdf9d.js"><link rel="prefetch" href="/notes-page/assets/js/43.af90fbe0.js"><link rel="prefetch" href="/notes-page/assets/js/44.f4d1f0bc.js"><link rel="prefetch" href="/notes-page/assets/js/46.3b17ee35.js"><link rel="prefetch" href="/notes-page/assets/js/47.4c8607af.js"><link rel="prefetch" href="/notes-page/assets/js/48.53926e60.js"><link rel="prefetch" href="/notes-page/assets/js/49.8509dd10.js"><link rel="prefetch" href="/notes-page/assets/js/50.2988ca9e.js"><link rel="prefetch" href="/notes-page/assets/js/51.9cfb4e4d.js"><link rel="prefetch" href="/notes-page/assets/js/52.1af19789.js"><link rel="prefetch" href="/notes-page/assets/js/53.c8145d27.js"><link rel="prefetch" href="/notes-page/assets/js/54.64e85de6.js"><link rel="prefetch" href="/notes-page/assets/js/55.61c8484a.js"><link rel="prefetch" href="/notes-page/assets/js/56.687836a0.js"><link rel="prefetch" href="/notes-page/assets/js/57.d8f3652a.js"><link rel="prefetch" href="/notes-page/assets/js/58.2a1077c6.js"><link rel="prefetch" href="/notes-page/assets/js/59.0967101b.js"><link rel="prefetch" href="/notes-page/assets/js/6.d7ec85da.js"><link rel="prefetch" href="/notes-page/assets/js/60.b02eb916.js"><link rel="prefetch" href="/notes-page/assets/js/61.8dc95ed1.js"><link rel="prefetch" href="/notes-page/assets/js/62.6f52f57a.js"><link rel="prefetch" href="/notes-page/assets/js/63.83345479.js"><link rel="prefetch" href="/notes-page/assets/js/64.fcbfa391.js"><link rel="prefetch" href="/notes-page/assets/js/65.c5dc1954.js"><link rel="prefetch" href="/notes-page/assets/js/66.c2b99914.js"><link rel="prefetch" href="/notes-page/assets/js/67.b3fb6b2a.js"><link rel="prefetch" href="/notes-page/assets/js/68.146d5468.js"><link rel="prefetch" href="/notes-page/assets/js/69.5dcd8c20.js"><link rel="prefetch" href="/notes-page/assets/js/7.5a68d3a6.js"><link rel="prefetch" href="/notes-page/assets/js/70.4c3bb81c.js"><link rel="prefetch" href="/notes-page/assets/js/71.b8964806.js"><link rel="prefetch" href="/notes-page/assets/js/72.f5f65b1b.js"><link rel="prefetch" href="/notes-page/assets/js/73.fb56e504.js"><link rel="prefetch" href="/notes-page/assets/js/74.1ace3ffc.js"><link rel="prefetch" href="/notes-page/assets/js/75.0beb2623.js"><link rel="prefetch" href="/notes-page/assets/js/76.5da3d39b.js"><link rel="prefetch" href="/notes-page/assets/js/77.9b8f1921.js"><link rel="prefetch" href="/notes-page/assets/js/78.2c86419a.js"><link rel="prefetch" href="/notes-page/assets/js/79.3edb83ce.js"><link rel="prefetch" href="/notes-page/assets/js/8.e56ce58a.js"><link rel="prefetch" href="/notes-page/assets/js/80.6817a2b1.js"><link rel="prefetch" href="/notes-page/assets/js/81.a32b9581.js"><link rel="prefetch" href="/notes-page/assets/js/82.dfc1469d.js"><link rel="prefetch" href="/notes-page/assets/js/83.4b3e81de.js"><link rel="prefetch" href="/notes-page/assets/js/84.e88b068b.js"><link rel="prefetch" href="/notes-page/assets/js/85.b04ac676.js"><link rel="prefetch" href="/notes-page/assets/js/86.d295b3eb.js"><link rel="prefetch" href="/notes-page/assets/js/87.180b3902.js"><link rel="prefetch" href="/notes-page/assets/js/88.bc771b73.js"><link rel="prefetch" href="/notes-page/assets/js/89.f8661312.js"><link rel="prefetch" href="/notes-page/assets/js/9.fae1b040.js"><link rel="prefetch" href="/notes-page/assets/js/90.0213a25c.js"><link rel="prefetch" href="/notes-page/assets/js/91.30da6719.js"><link rel="prefetch" href="/notes-page/assets/js/92.dd966c86.js"><link rel="prefetch" href="/notes-page/assets/js/93.acfc2f76.js"><link rel="prefetch" href="/notes-page/assets/js/94.a02a612d.js"><link rel="prefetch" href="/notes-page/assets/js/95.4461ed9f.js"><link rel="prefetch" href="/notes-page/assets/js/96.fd405fbb.js"><link rel="prefetch" href="/notes-page/assets/js/97.17eed19b.js"><link rel="prefetch" href="/notes-page/assets/js/98.084b519b.js"><link rel="prefetch" href="/notes-page/assets/js/99.3628a689.js"><link rel="prefetch" href="/notes-page/assets/js/vendors~docsearch.87a44fb1.js"><link rel="prefetch" href="/notes-page/assets/js/vendors~photo-swipe.9ed823be.js"><link rel="prefetch" href="/notes-page/assets/js/vendors~search-page.1113aab2.js">
    <link rel="stylesheet" href="/notes-page/assets/css/0.styles.1de91c51.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/notes-page/" class="home-link router-link-active"><!----> <span class="site-name">å¤§å‰ç«¯ - å‰ç«¯é«˜çº§è¿›é˜¶</span></a> <div class="links"><div id="docsearch"></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>å°ç¨‹åº</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes-page/project/community-miniapp/" class="sidebar-link">uniappä»‹ç»</a></li><li><a href="/notes-page/project/community-miniapp/01-æ­å»ºå¼€å‘ç¯å¢ƒ.html" class="sidebar-link">æ­å»ºå¼€å‘ç¯å¢ƒ</a></li><li><a href="/notes-page/project/community-miniapp/02-é¦–é¡µæ¨¡å—.html" class="sidebar-link">é¦–é¡µæ¨¡å—</a></li><li><a href="/notes-page/project/community-miniapp/03-ç™»å½•é‰´æƒ.html" class="sidebar-link">å°ç¨‹åºé‰´æƒç™»å½•</a></li><li><a href="/notes-page/project/community-miniapp/04-æ¶ˆæ¯&amp;çƒ­é—¨&amp;ä¸ªäººä¸­å¿ƒ.html" class="sidebar-link">æ¶ˆæ¯&amp;çƒ­é—¨&amp;ä¸ªäººä¸­å¿ƒ</a></li><li><a href="/notes-page/project/community-miniapp/05-RefreshTokenæœºåˆ¶.html" class="sidebar-link">RefreshTokenæœºåˆ¶</a></li><li><a href="/notes-page/project/community-miniapp/06-æ–‡ç« è¯¦æƒ….html" class="sidebar-link">æ–‡ç« è¯¦æƒ…</a></li><li><a href="/notes-page/project/community-miniapp/07-å®‰å…¨åŸŸåç›¸å…³.html" class="sidebar-link">å®‰å…¨åŸŸåç›¸å…³</a></li><li><a href="/notes-page/project/community-miniapp/08-è®¢é˜…æ¶ˆæ¯.html" class="sidebar-link">è®¢é˜…æ¶ˆæ¯</a></li><li><a href="/notes-page/project/community-miniapp/09-å†…å®¹å®‰å…¨.html" class="sidebar-link">å†…å®¹å®‰å…¨</a></li><li><a href="/notes-page/project/community-miniapp/10-å‘è´´&amp;è¯„è®ºåŠŸèƒ½.html" class="sidebar-link">å‘è´´è¯„è®ºåŠŸèƒ½</a></li><li><a href="/notes-page/project/community-miniapp/11-å‘å¸ƒä¸Šçº¿.html" class="sidebar-link">å‘å¸ƒä¸Šçº¿</a></li><li><a href="/notes-page/project/community-miniapp/12-æ”¯ä»˜ä¸“é¢˜.html" class="sidebar-link">æ”¯ä»˜ä¸“é¢˜</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Flutter 2.0</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes-page/project/community-flutter/" aria-current="page" class="sidebar-link">Flutter</a></li><li><a href="/notes-page/project/community-flutter/01-é£æ ¼æŒ‡å—.html" class="sidebar-link">é£æ ¼æŒ‡å—</a></li><li><a href="/notes-page/project/community-flutter/02-Flutterå…¥é—¨.html" class="sidebar-link">Flutterå…¥é—¨æ¡ˆä¾‹</a></li><li><a href="/notes-page/project/community-flutter/03-å¼‚æ­¥ç¼–ç¨‹æ€æƒ³.html" class="sidebar-link">å¼‚æ­¥ç¼–ç¨‹æ€æƒ³</a></li><li><a href="/notes-page/project/community-flutter/04-çŠ¶æ€ç®¡ç†.html" class="sidebar-link">çŠ¶æ€ç®¡ç†æ¦‚è§ˆ</a></li><li><a href="/notes-page/project/community-flutter/05-çŠ¶æ€ç®¡ç†-redux.html" class="sidebar-link">çŠ¶æ€ç®¡ç†æ–¹æ¡ˆ-Redux</a></li><li><a href="/notes-page/project/community-flutter/06-çŠ¶æ€ç®¡ç†-scoped_model.html" class="sidebar-link">çŠ¶æ€ç®¡ç†æ–¹æ¡ˆ-ScopedModel</a></li><li><a href="/notes-page/project/community-flutter/07-çŠ¶æ€ç®¡ç†-bloc.html" class="sidebar-link">çŠ¶æ€ç®¡ç†æ–¹æ¡ˆ-Bloc</a></li><li><a href="/notes-page/project/community-flutter/08-è·å–éªŒè¯ç .html" class="sidebar-link">è·å–éªŒè¯ç </a></li><li><a href="/notes-page/project/community-flutter/09-å°è£…è¯·æ±‚.html" class="sidebar-link">å°è£…è¯·æ±‚</a></li><li><a href="/notes-page/project/community-flutter/10-ç½‘ç»œæµ‹è¯•.html" class="sidebar-link">ç½‘ç»œè°ƒè¯•</a></li><li><a href="/notes-page/project/community-flutter/11-åˆ›å»ºçŸ­ä¿¡æ¥å£æœåŠ¡.html" class="sidebar-link">åˆ›å»ºå‘é€çŸ­ä¿¡éªŒè¯ç æœåŠ¡</a></li><li><a href="/notes-page/project/community-flutter/12-åºåˆ—åŒ–.html" class="sidebar-link">åºåˆ—åŒ–</a></li><li><a href="/notes-page/project/community-flutter/13-è‡ªå®šä¹‰toastç»„ä»¶.html" class="sidebar-link">è‡ªå®šä¹‰toastç»„ä»¶</a></li><li><a href="/notes-page/project/community-flutter/14-ä¼˜åŒ–çŸ­ä¿¡éªŒè¯ç é€»è¾‘.html" class="sidebar-link">ä¼˜åŒ–çŸ­ä¿¡éªŒè¯ç é€»è¾‘</a></li><li><a href="/notes-page/project/community-flutter/15-æ•°æ®æŒä¹…åŒ–-getstorage.html" class="sidebar-link">æ•°æ®æŒä¹…åŒ–-GetStorage</a></li><li><a href="/notes-page/project/community-flutter/16-æ•°æ®æŒä¹…åŒ–-sqflite.html" class="sidebar-link">æ•°æ®æŒä¹…åŒ–-Sqflite</a></li><li><a href="/notes-page/project/community-flutter/17-è·¯ç”±.html" class="sidebar-link">è·¯ç”±</a></li><li><a href="/notes-page/project/community-flutter/18-é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é….html" class="active sidebar-link">é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é…</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes-page/project/community-flutter/18-é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é….html#é›†æˆæ–¹æ¡ˆ" class="sidebar-link">é›†æˆæ–¹æ¡ˆ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes-page/project/community-flutter/18-é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é….html#getx" class="sidebar-link">GetX</a></li><li class="sidebar-sub-header"><a href="/notes-page/project/community-flutter/18-é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é….html#velocity-x" class="sidebar-link">velocity_x</a></li></ul></li><li class="sidebar-sub-header"><a href="/notes-page/project/community-flutter/18-é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é….html#websocketæ¶ˆæ¯" class="sidebar-link">WebSocketæ¶ˆæ¯</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes-page/project/community-flutter/18-é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é….html#å®‰è£…ä¾èµ–" class="sidebar-link">å®‰è£…ä¾èµ–</a></li><li class="sidebar-sub-header"><a href="/notes-page/project/community-flutter/18-é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é….html#websocketåˆå§‹åŒ–" class="sidebar-link">websocketåˆå§‹åŒ–</a></li><li class="sidebar-sub-header"><a href="/notes-page/project/community-flutter/18-é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é….html#å‘é€æ¶ˆæ¯" class="sidebar-link">å‘é€æ¶ˆæ¯</a></li><li class="sidebar-sub-header"><a href="/notes-page/project/community-flutter/18-é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é….html#å¿ƒè·³æ£€æµ‹" class="sidebar-link">å¿ƒè·³æ£€æµ‹</a></li><li class="sidebar-sub-header"><a href="/notes-page/project/community-flutter/18-é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é….html#æ–­çº¿é‡è¿" class="sidebar-link">æ–­çº¿é‡è¿</a></li><li class="sidebar-sub-header"><a href="/notes-page/project/community-flutter/18-é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é….html#å…³é—­è¿æ¥" class="sidebar-link">å…³é—­è¿æ¥</a></li><li class="sidebar-sub-header"><a href="/notes-page/project/community-flutter/18-é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é….html#å®Œæ•´ä»£ç " class="sidebar-link">å®Œæ•´ä»£ç </a></li></ul></li><li class="sidebar-sub-header"><a href="/notes-page/project/community-flutter/18-é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é….html#æœ¬åœ°æ¶ˆæ¯æ¨é€" class="sidebar-link">æœ¬åœ°æ¶ˆæ¯æ¨é€</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes-page/project/community-flutter/18-é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é….html#å®‰è£…ä¾èµ–-2" class="sidebar-link">å®‰è£…ä¾èµ–</a></li><li class="sidebar-sub-header"><a href="/notes-page/project/community-flutter/18-é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é….html#åŸºç¡€ç¤ºä¾‹" class="sidebar-link">åŸºç¡€ç¤ºä¾‹</a></li><li class="sidebar-sub-header"><a href="/notes-page/project/community-flutter/18-é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é….html#å¦‚ä½•æµ‹è¯•å‘¢" class="sidebar-link">å¦‚ä½•æµ‹è¯•å‘¢ï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/notes-page/project/community-flutter/18-é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é….html#å£°éŸ³ä¸éœ‡åŠ¨" class="sidebar-link">å£°éŸ³ä¸éœ‡åŠ¨</a></li></ul></li><li class="sidebar-sub-header"><a href="/notes-page/project/community-flutter/18-é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é….html#é¦–é¡µå¯¼èˆª" class="sidebar-link">é¦–é¡µå¯¼èˆª</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes-page/project/community-flutter/18-é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é….html#å±å¹•é€‚é…" class="sidebar-link">å±å¹•é€‚é…</a></li><li class="sidebar-sub-header"><a href="/notes-page/project/community-flutter/18-é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é….html#åº•éƒ¨å¯¼èˆª" class="sidebar-link">åº•éƒ¨å¯¼èˆª</a></li><li class="sidebar-sub-header"><a href="/notes-page/project/community-flutter/18-é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é….html#ä¸‹æ‹‰åˆ·æ–°-ä¸Šæ‹‰åŠ è½½" class="sidebar-link">ä¸‹æ‹‰åˆ·æ–°ï¼ˆä¸Šæ‹‰åŠ è½½ï¼‰</a></li><li class="sidebar-sub-header"><a href="/notes-page/project/community-flutter/18-é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é….html#é•¿åˆ—è¡¨å¼‚æ­¥æ•°æ®æ–¹æ¡ˆ" class="sidebar-link">é•¿åˆ—è¡¨å¼‚æ­¥æ•°æ®æ–¹æ¡ˆ</a></li></ul></li></ul></li><li><a href="/notes-page/project/community-flutter/19-è‹¹æœå¼€å‘è€….html" class="sidebar-link">è‹¹æœå¼€å‘è€…</a></li><li><a href="/notes-page/project/community-flutter/20-å¯åŠ¨å›¾æ ‡ä¸å¯åŠ¨å›¾.html" class="sidebar-link">é…ç½®åº”ç”¨å›¾æ ‡ä¸å¯åŠ¨å›¾</a></li><li><a href="/notes-page/project/community-flutter/21-æ—¥å¿—æ”¶é›†.html" class="sidebar-link">é”™è¯¯æ—¥å¿—æ”¶é›†</a></li><li><a href="/notes-page/project/community-flutter/22-æ‰“åŒ….html" class="sidebar-link">ç§»åŠ¨ç«¯æ‰“åŒ…</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Electronæ¡Œé¢ç«¯</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes-page/project/community-electron/" class="sidebar-link">æ•´ä½“ä»‹ç»</a></li><li><a href="/notes-page/project/community-electron/01-æ ¸å¿ƒæ¦‚å¿µ.html" class="sidebar-link">æ ¸å¿ƒæ¦‚å¿µ</a></li><li><a href="/notes-page/project/community-electron/02-ä¸ä¸»æµæ¡†æ¶é›†æˆ.html" class="sidebar-link">ä¸ä¸»æµçš„æ¡†æ¶é›†æˆ</a></li><li><a href="/notes-page/project/community-electron/03-ç¤¾åŒºé¡¹ç›®æ•´åˆ.html" class="sidebar-link">ä¸šåŠ¡é¡¹ç›®æ•´åˆ</a></li><li><a href="/notes-page/project/community-electron/04-ç¬¬ä¸‰æ–¹ç™»å½•æ‰«ç ç™»å½•.html" class="sidebar-link">ç¬¬ä¸‰æ–¹ç™»å½•ï¼ˆæ‰«ç ç™»å½•ï¼‰</a></li><li><a href="/notes-page/project/community-electron/05-åŸç”Ÿåº”ç”¨é€šçŸ¥.html" class="sidebar-link">åŸç”Ÿåº”ç”¨é€šçŸ¥</a></li><li><a href="/notes-page/project/community-electron/06-æ‰“åŒ…ä¸æ›´æ–°.html" class="sidebar-link">Electronæ‰“åŒ…</a></li><li><a href="/notes-page/project/community-electron/07-å¤šå¹³å°æ‰“åŒ….html" class="sidebar-link">å¤šå¹³å°æ‰“åŒ…</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Reactä¸–ç•Œ</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes-page/project/react/" class="sidebar-link">Reacté¡¹ç›®</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="é›†æˆæ–¹æ¡ˆ-æ¶ˆæ¯-é€‚é…"><a href="#é›†æˆæ–¹æ¡ˆ-æ¶ˆæ¯-é€‚é…" class="header-anchor">#</a> é›†æˆæ–¹æ¡ˆ&amp;æ¶ˆæ¯&amp;é€‚é…</h1> <h2 id="é›†æˆæ–¹æ¡ˆ"><a href="#é›†æˆæ–¹æ¡ˆ" class="header-anchor">#</a> é›†æˆæ–¹æ¡ˆ</h2> <p>Flutterä¸­æœ‰ä¸€äº›æ¯”è¾ƒæˆç†Ÿçš„é›†æˆæ–¹æ¡ˆï¼Œå³åŒ…å«ï¼š</p> <ul><li>çŠ¶æ€ç®¡ç†</li> <li>ä¾èµ–ç®¡ç†</li> <li>å­˜å‚¨</li> <li>è·¯ç”±</li> <li>å›½é™…åŒ–</li> <li>è¿‡æ¸¡æ•ˆæœ</li> <li>....</li></ul> <h3 id="getx"><a href="#getx" class="header-anchor">#</a> GetX</h3> <p><img src="/notes-page/assets/img/get.bedebe85.png" alt="img"></p> <p>å®˜æ–¹åœ°å€ï¼š<a href="https://pub.dev/packages/get" target="_blank" rel="noopener noreferrer">https://pub.dev/packages/get<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>ç‰¹ç‚¹ï¼š</p> <ul><li>çŠ¶æ€ç®¡ç†ã€è·¯ç”±ã€ä¾èµ–ç®¡ç†</li> <li>è¿‡æ¸¡åŠ¨ç”»ã€å›½é™…åŒ–</li> <li>HTTPè¯·æ±‚</li> <li>é¡µé¢å¯¼èˆª</li> <li>æœ¬åœ°çŠ¶æ€ã€æœåŠ¡ã€å“åº”ã€ç»„ä»¶ç®¡ç†</li></ul> <h3 id="velocity-x"><a href="#velocity-x" class="header-anchor">#</a> velocity_x</h3> <p><img src="/notes-page/assets/img/GcsbeIW.38ebceb6.png" alt="VelocityX"></p> <p>å®˜æ–¹åœ°å€ï¼š<a href="https://pub.dev/packages/velocity_x" target="_blank" rel="noopener noreferrer">https://pub.dev/packages/velocity_x<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>ç‰¹ç‚¹å¦‚ä¸Šå›¾ã€‚</p> <h2 id="websocketæ¶ˆæ¯"><a href="#websocketæ¶ˆæ¯" class="header-anchor">#</a> WebSocketæ¶ˆæ¯</h2> <p>Flutterä¸­æœ‰ä¸¤ä¸ªWSæ”¯æŒçš„åŒ…ï¼š</p> <ul><li>web_socket_channel</li> <li>socket_io_client</li></ul> <h3 id="å®‰è£…ä¾èµ–"><a href="#å®‰è£…ä¾èµ–" class="header-anchor">#</a> å®‰è£…ä¾èµ–</h3> <div class="language-dart extra-class"><pre class="language-dart"><code>dependencies<span class="token punctuation">:</span>
  web_socket_channel<span class="token punctuation">:</span> <span class="token operator">^</span><span class="token number">2.1</span><span class="token number">.0</span>
</code></pre></div><h3 id="websocketåˆå§‹åŒ–"><a href="#websocketåˆå§‹åŒ–" class="header-anchor">#</a> websocketåˆå§‹åŒ–</h3> <p>æ·»åŠ wsè¿æ¥çš„é…ç½®ä¿¡æ¯åˆ°<code>config.dart</code>ï¼š</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">enum</span> <span class="token class-name">Env</span> <span class="token punctuation">{</span> <span class="token class-name">Dev</span><span class="token punctuation">,</span> <span class="token class-name">Prod</span> <span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Config</span> <span class="token punctuation">{</span>
  <span class="token comment">// ..</span>
  <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token class-name">String</span> wsUrl <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'ws://192.168.31.132:3001'</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>ä½¿ç”¨è‡ªå·±æœ¬åœ°çš„IPï¼Œæ³¨æ„åè®®æ˜¯<code>ws</code>ã€‚</p></blockquote> <p>åˆ›å»ºæ–‡ä»¶<code>utils/websocket_utils.dart</code>ï¼š</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:web_socket_channel/io.dart'</span></span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">WebSocketUtils</span> <span class="token punctuation">{</span>
  <span class="token keyword">final</span> <span class="token class-name">String</span> url<span class="token punctuation">;</span>
  <span class="token keyword">final</span> <span class="token class-name">Function</span><span class="token operator">?</span> onOpen<span class="token punctuation">;</span>
  <span class="token keyword">final</span> <span class="token class-name">Function</span><span class="token operator">?</span> onMessage<span class="token punctuation">;</span>
  <span class="token keyword">final</span> <span class="token class-name">Function</span><span class="token operator">?</span> onError<span class="token punctuation">;</span>
  <span class="token keyword">final</span> <span class="token class-name">Iterable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token operator">?</span> protocols<span class="token punctuation">;</span>
  <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token keyword">dynamic</span><span class="token punctuation">&gt;</span></span><span class="token operator">?</span> headers<span class="token punctuation">;</span>

  <span class="token comment">// åˆå§‹åŒ–</span>
  <span class="token class-name">WebSocketUtils</span><span class="token punctuation">(</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>onOpen<span class="token punctuation">,</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>onMessage<span class="token punctuation">,</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>onError<span class="token punctuation">,</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>protocols<span class="token punctuation">,</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>headers<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è¿™é‡Œæ˜¯æ„é€ å‡½æ•°çš„å‡½æ•°ä½“ï¼Œå¯ä»¥ç›´æ¥å®Œæˆåˆå§‹åŒ–</span>
    <span class="token function">openSocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token class-name">IOWebSocketChannel</span><span class="token operator">?</span> _websocket<span class="token punctuation">;</span>
  <span class="token comment">// Function? onOpen;</span>
  <span class="token comment">// Function? onMessage;</span>
  <span class="token comment">// Function? onError;</span>

  <span class="token comment">// void initWebSocket(</span>
  <span class="token comment">//     {Function? onOpen, Function? onMessage, Function? onError}) {</span>
  <span class="token comment">//   this.onOpen = onOpen;</span>
  <span class="token comment">//   this.onMessage = onMessage;</span>
  <span class="token comment">//   this.onError = onError;</span>
  <span class="token comment">//   // è¿æ¥ -&gt; æ¥æ”¶æ¶ˆæ¯</span>
  <span class="token comment">//   openSocket();</span>
  <span class="token comment">// }</span>

  <span class="token keyword">void</span> <span class="token function">openSocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _websocket <span class="token operator">=</span> <span class="token class-name">IOWebSocketChannel</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token class-name">Uri</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>onOpen <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> onOpen<span class="token operator">!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è·å–WebSocketçš„è¿æ¥æ¶ˆæ¯</span>
    _websocket<span class="token operator">!</span><span class="token punctuation">.</span>stream<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'event is ğŸ‘‰ </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">event</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>onMessage <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> onMessage<span class="token operator">!</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> onError<span class="token punctuation">:</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'err is ğŸ‘‰ </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">err</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> onDone<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'close websocket'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// todo æ–­çº¿é‡è¿</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å‘é€æ¶ˆæ¯</span>
  <span class="token comment">// å…³é—­è¿æ¥</span>
  <span class="token comment">// æ–­çº¿é‡è¿</span>
  <span class="token comment">// å¿ƒè·³æ£€æµ‹</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åœ¨<code>main.dart</code>ä¸­å®Œæˆåˆå§‹åŒ–ï¼š</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
  <span class="token function">setupGetIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  getIt<span class="token punctuation">.</span>registerSingleton<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WebSocketUtils</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">WebSocketUtils</span><span class="token punctuation">(</span><span class="token class-name">Config</span><span class="token punctuation">.</span>wsUrl<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// WebSocketUtils webSocketUtils = getIt&lt;WebSocketUtils&gt;();</span>
  <span class="token function">runApp</span><span class="token punctuation">(</span><span class="token class-name">MyApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="å‘é€æ¶ˆæ¯"><a href="#å‘é€æ¶ˆæ¯" class="header-anchor">#</a> å‘é€æ¶ˆæ¯</h3> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token comment">// å‘é€æ¶ˆæ¯</span>
<span class="token keyword">void</span> <span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>_websocket <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _websocket<span class="token operator">!</span><span class="token punctuation">.</span>sink<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="å¿ƒè·³æ£€æµ‹"><a href="#å¿ƒè·³æ£€æµ‹" class="header-anchor">#</a> å¿ƒè·³æ£€æµ‹</h3> <p>è°ƒæ•´<code>openSocket</code>æ–¹æ³•ï¼š</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">void</span> <span class="token function">openSocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  _websocket <span class="token operator">=</span> <span class="token class-name">IOWebSocketChannel</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token class-name">Uri</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>onOpen <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> onOpen<span class="token operator">!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// è·å–WebSocketçš„è¿æ¥æ¶ˆæ¯</span>
  _websocket<span class="token operator">!</span><span class="token punctuation">.</span>stream<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'event is ğŸ‘‰ </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">event</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token keyword">dynamic</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> json<span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">as</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token keyword">dynamic</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">'event'</span></span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string-literal"><span class="token string">'heartbeat'</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å¿ƒè·³æ£€æµ‹</span>
        <span class="token function">sendMessage</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string-literal"><span class="token string">'event'</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'heartbeat'</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'message'</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'pong'</span></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>onMessage <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> onMessage<span class="token operator">!</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'err is ğŸ‘‰ </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">err</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// finally {</span>
    <span class="token comment">//   if (onMessage != null) onMessage!(event);</span>
    <span class="token comment">// }</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> onError<span class="token punctuation">:</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// todo</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'close websocket'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="æ–­çº¿é‡è¿"><a href="#æ–­çº¿é‡è¿" class="header-anchor">#</a> æ–­çº¿é‡è¿</h3> <p>æ–­çº¿éœ€è¦æ¯éš”ä¸€æ®µæ—¶é—´è¿›è¡Œé‡è¿ï¼Œè¿™é‡Œå°±éœ€è¦æœ‰ä¸€ä¸ªè®¡æ—¶å™¨</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">class</span> <span class="token class-name">WebSocketUtils</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token class-name">Timer</span><span class="token operator">?</span> _reconnectTimer<span class="token punctuation">;</span>

  <span class="token keyword">void</span> <span class="token function">openSocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _websocket <span class="token operator">=</span> <span class="token class-name">IOWebSocketChannel</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token class-name">Uri</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_reconnectTimer <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      _reconnectTimer<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      _reconnectTimer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>onOpen <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> onOpen<span class="token operator">!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è·å–WebSocketçš„è¿æ¥æ¶ˆæ¯</span>
    _websocket<span class="token operator">!</span><span class="token punctuation">.</span>stream<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// ..</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> onError<span class="token punctuation">:</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'err is ğŸ‘‰ </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">err</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>onError <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> onError<span class="token operator">!</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">reconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> onDone<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// onDone</span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'close websocket'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// æ–­çº¿é‡è¿</span>
  <span class="token keyword">void</span> <span class="token function">reconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _reconnectTimer <span class="token operator">=</span> <span class="token class-name">Timer</span><span class="token punctuation">.</span><span class="token function">periodic</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">(</span>seconds<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">openSocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'é‡æ–°è¿æ¥ä¸­'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre></div><h3 id="å…³é—­è¿æ¥"><a href="#å…³é—­è¿æ¥" class="header-anchor">#</a> å…³é—­è¿æ¥</h3> <p>å…¶å®ä»£ç æ¯”è¾ƒç®€å•ï¼š</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token comment">// å…³é—­è¿æ¥</span>
<span class="token keyword">void</span> <span class="token function">closeSocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>_websocket <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  	_websocket<span class="token operator">!</span><span class="token punctuation">.</span>sink<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä¸»è¦æ˜¯æ§åˆ¶<code>sink</code>è¿›è¡Œ<code>close</code>ï¼ˆè‡ªå¸¦æ–¹æ³•ï¼‰å³å¯ã€‚</p> <h3 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="header-anchor">#</a> å®Œæ•´ä»£ç </h3> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'dart:async'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'dart:convert'</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:web_socket_channel/io.dart'</span></span><span class="token punctuation">;</span>

<span class="token keyword">enum</span> <span class="token class-name">SocketStatus</span> <span class="token punctuation">{</span>
  connected<span class="token punctuation">,</span>
  error<span class="token punctuation">,</span>
  closed<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">WebSocketUtils</span> <span class="token punctuation">{</span>
  <span class="token keyword">final</span> <span class="token class-name">String</span> url<span class="token punctuation">;</span>
  <span class="token keyword">final</span> <span class="token class-name">Function</span><span class="token operator">?</span> onOpen<span class="token punctuation">;</span>
  <span class="token keyword">final</span> <span class="token class-name">Function</span><span class="token operator">?</span> onMessage<span class="token punctuation">;</span>
  <span class="token keyword">final</span> <span class="token class-name">Function</span><span class="token operator">?</span> onError<span class="token punctuation">;</span>
  <span class="token keyword">final</span> <span class="token class-name">Iterable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token operator">?</span> protocols<span class="token punctuation">;</span>
  <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token keyword">dynamic</span><span class="token punctuation">&gt;</span></span><span class="token operator">?</span> headers<span class="token punctuation">;</span>
  <span class="token class-name">Timer</span><span class="token operator">?</span> _reconnectTimer<span class="token punctuation">;</span>
  <span class="token comment">// ignore: close_sinks</span>
  <span class="token class-name">StreamController</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SocketStatus</span><span class="token punctuation">&gt;</span></span> _controller <span class="token operator">=</span> <span class="token class-name">StreamController</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SocketStatus</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">SocketStatus</span> _socketStatus <span class="token operator">=</span> <span class="token class-name">SocketStatus</span><span class="token punctuation">.</span>closed<span class="token punctuation">;</span>

  <span class="token class-name">Stream</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SocketStatus</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">get</span> statusStream <span class="token operator">=</span><span class="token operator">&gt;</span> _controller<span class="token punctuation">.</span>stream<span class="token punctuation">;</span>
  <span class="token class-name">SocketStatus</span> <span class="token keyword">get</span> socketStatus <span class="token operator">=</span><span class="token operator">&gt;</span> _socketStatus<span class="token punctuation">;</span>

  <span class="token comment">// åˆå§‹åŒ–</span>
  <span class="token class-name">WebSocketUtils</span><span class="token punctuation">(</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>onOpen<span class="token punctuation">,</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>onMessage<span class="token punctuation">,</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>onError<span class="token punctuation">,</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>protocols<span class="token punctuation">,</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>headers<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">openSocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token class-name">IOWebSocketChannel</span><span class="token operator">?</span> _websocket<span class="token punctuation">;</span>
  <span class="token comment">// Function? onOpen;</span>
  <span class="token comment">// Function? onMessage;</span>
  <span class="token comment">// Function? onError;</span>

  <span class="token comment">// void initWebSocket(</span>
  <span class="token comment">//     {Function? onOpen, Function? onMessage, Function? onError}) {</span>
  <span class="token comment">//   this.onOpen = onOpen;</span>
  <span class="token comment">//   this.onMessage = onMessage;</span>
  <span class="token comment">//   this.onError = onError;</span>
  <span class="token comment">//   // è¿æ¥ -&gt; æ¥æ”¶æ¶ˆæ¯</span>
  <span class="token comment">//   openSocket();</span>
  <span class="token comment">// }</span>

  <span class="token keyword">void</span> <span class="token function">openSocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _websocket <span class="token operator">=</span> <span class="token class-name">IOWebSocketChannel</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token class-name">Uri</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    _controller<span class="token punctuation">.</span>sink<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">SocketStatus</span><span class="token punctuation">.</span>connected<span class="token punctuation">)</span><span class="token punctuation">;</span>
    _socketStatus <span class="token operator">=</span> <span class="token class-name">SocketStatus</span><span class="token punctuation">.</span>connected<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_reconnectTimer <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      _reconnectTimer<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      _reconnectTimer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>onOpen <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> onOpen<span class="token operator">!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è·å–WebSocketçš„è¿æ¥æ¶ˆæ¯</span>
    _websocket<span class="token operator">!</span><span class="token punctuation">.</span>stream<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'event is ğŸ‘‰ </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">event</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token keyword">dynamic</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> json<span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">as</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token keyword">dynamic</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">'event'</span></span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string-literal"><span class="token string">'heartbeat'</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// å¿ƒè·³æ£€æµ‹</span>
          <span class="token function">sendMessage</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string-literal"><span class="token string">'event'</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'heartbeat'</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'message'</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'pong'</span></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>onMessage <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> onMessage<span class="token operator">!</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'err is ğŸ‘‰ </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">err</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// finally {</span>
      <span class="token comment">//   if (onMessage != null) onMessage!(event);</span>
      <span class="token comment">// }</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> onError<span class="token punctuation">:</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'err is ğŸ‘‰ </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">err</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      _controller<span class="token punctuation">.</span>sink<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">SocketStatus</span><span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
      _socketStatus <span class="token operator">=</span> <span class="token class-name">SocketStatus</span><span class="token punctuation">.</span>error<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>onError <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> onError<span class="token operator">!</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">reconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> onDone<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      _controller<span class="token punctuation">.</span>sink<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">SocketStatus</span><span class="token punctuation">.</span>closed<span class="token punctuation">)</span><span class="token punctuation">;</span>
      _socketStatus <span class="token operator">=</span> <span class="token class-name">SocketStatus</span><span class="token punctuation">.</span>closed<span class="token punctuation">;</span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'close websocket'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å‘é€æ¶ˆæ¯</span>
  <span class="token keyword">void</span> <span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_websocket <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      _websocket<span class="token operator">!</span><span class="token punctuation">.</span>sink<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å…³é—­è¿æ¥</span>
  <span class="token keyword">void</span> <span class="token function">closeSocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_websocket <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      _websocket<span class="token operator">!</span><span class="token punctuation">.</span>sink<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// æ–­çº¿é‡è¿</span>
  <span class="token keyword">void</span> <span class="token function">reconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _reconnectTimer <span class="token operator">=</span> <span class="token class-name">Timer</span><span class="token punctuation">.</span><span class="token function">periodic</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">(</span>seconds<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">openSocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'é‡æ–°è¿æ¥ä¸­'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// æ‰‹åŠ¨é”€æ¯controllerä¸socketï¼Œå¸®åŠ©å›æ”¶å†…å­˜</span>
  <span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    _controller<span class="token punctuation">.</span>sink<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">closeSocket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="æœ¬åœ°æ¶ˆæ¯æ¨é€"><a href="#æœ¬åœ°æ¶ˆæ¯æ¨é€" class="header-anchor">#</a> æœ¬åœ°æ¶ˆæ¯æ¨é€</h2> <p>æœ¬åœ°æ¶ˆæ¯æ¨é€ç¬¬ä¸‰æ–¹æ–¹æ¡ˆ<code>flutter_local_notifications</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªè·¨å¹³å°çš„æœ¬åœ°åŒ–æ¶ˆæ¯æ¨é€æ–¹æ¡ˆï¼Œå®˜æ–¹ç½‘å€<a href="https://pub.dev/packages/flutter_local_notifications" target="_blank" rel="noopener noreferrer">https://pub.dev/packages/flutter_local_notifications<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p> <p>å¹³å°æ”¯æŒï¼š</p> <ul><li>å®‰å“4.1ä»¥ä¸Šã€‚ä½¿ç”¨NotificationCompat APIsï¼Œæ‰€ä»¥å¯ä»¥è¿è¡Œæ—§çš„Androidè®¾å¤‡ã€‚</li> <li>iOS 8.0ä»¥ä¸Šã€‚åœ¨è¶…è¿‡10çš„iOSç‰ˆæœ¬ä¸Šï¼Œè¯¥æ’ä»¶å°†ä½¿ç”¨UILocalNotification APIsã€‚UserNotification APIsï¼ˆåˆç§°ç”¨æˆ·é€šçŸ¥æ¡†æ¶ï¼‰åœ¨iOS 10æˆ–æ›´æ–°çš„ç‰ˆæœ¬ä¸Šä½¿ç”¨ã€‚</li> <li>macOS 10.11ä»¥ä¸Šã€‚åœ¨10.14ä¹‹å‰çš„macOSç‰ˆæœ¬ä¸Šï¼Œè¯¥æ’ä»¶å°†ä½¿ç”¨NSUserNotification APIsã€‚UserNotification APIsï¼ˆåˆç§°ç”¨æˆ·é€šçŸ¥æ¡†æ¶ï¼‰åœ¨macOS 10.14æˆ–æ›´æ–°ç‰ˆæœ¬ä¸Šä½¿ç”¨ã€‚</li> <li>Linuxã€‚ä½¿ç”¨æ¡Œé¢é€šçŸ¥è§„èŒƒã€‚</li></ul> <h3 id="å®‰è£…ä¾èµ–-2"><a href="#å®‰è£…ä¾èµ–-2" class="header-anchor">#</a> å®‰è£…ä¾èµ–</h3> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">dependencies</span><span class="token punctuation">:</span>
  <span class="token key atrule">flutter_local_notifications</span><span class="token punctuation">:</span> ^9.2.0
</code></pre></div><p>ä½¿ç”¨<code>flutter pub get</code>å®‰è£…ä¾èµ–ã€‚</p> <p>iOSé…ç½®ï¼Œåœ¨iOSé¡¹ç›®çš„<code>ios/Runner/AppDelegate.m</code>æˆ–è€…<code>ios/Runner/AppDelegate.swift</code>æ–‡ä»¶ä¸­çš„<code>didFinishLaunchingWithOptions</code>æ–¹æ³•ä¸­åŠ å…¥ä»¥ä¸‹å‡ è¡Œ</p> <p>Objective-C:</p> <div class="language-objc extra-class"><pre class="language-objc"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">@</span><span class="token function">available</span><span class="token punctuation">(</span>iOS <span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>UNUserNotificationCenter currentNotificationCenter<span class="token punctuation">]</span><span class="token punctuation">.</span>delegate <span class="token operator">=</span> <span class="token punctuation">(</span>id<span class="token operator">&lt;</span>UNUserNotificationCenterDelegate<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token keyword">self</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Swift:</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">if</span> <span class="token other-directive property">#available</span><span class="token punctuation">(</span>iOS <span class="token number">10.0</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">UNUserNotificationCenter</span><span class="token punctuation">.</span><span class="token function">current</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>delegate <span class="token operator">=</span> <span class="token keyword">self</span> <span class="token keyword">as</span><span class="token operator">?</span> <span class="token class-name">UNUserNotificationCenterDelegate</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>ä»¥ä¸Šçš„ä»£ç ä¸€å®šè¦åŠ åœ¨<code>return</code>è¯­å¥ä¹‹å‰ã€‚</p></blockquote> <h3 id="åŸºç¡€ç¤ºä¾‹"><a href="#åŸºç¡€ç¤ºä¾‹" class="header-anchor">#</a> åŸºç¡€ç¤ºä¾‹</h3> <p>åˆå§‹åŒ–éœ€è¦å®Œæˆçš„å·¥ä½œï¼š</p> <ul><li><p>åˆå§‹åŒ–FlutterLocalNotificationsæ’ä»¶ï¼›</p></li> <li><p>åˆå§‹åŒ–æ¶ˆæ¯</p> <ul><li><p>è®¾ç½®androidå›¾æ ‡ï¼›</p> <blockquote><p>è¿™é‡Œè¦æ³¨æ„ï¼Œ<code>android</code>ç›®å½•ä¸­æœ‰ä¸€ä¸ªç›®å½•<code>android/app/src/main/res</code>ï¼Œåœ¨reså°±æœ‰å›¾æ ‡äº†ã€‚</p></blockquote></li> <li><p>è·å–æƒé™</p></li> <li><p>æ¥æ”¶æ¶ˆæ¯å›è°ƒ</p></li> <li><p>æ¶ˆæ¯åˆå§‹åŒ–ï¼ˆiosä¸androidå¹³å°ï¼‰</p></li></ul></li> <li><p>å›è°ƒæ–¹æ³•å®šä¹‰ï¼šæ˜¾ç¤ºæ¶ˆæ¯ã€ç‚¹å‡»æ¶ˆæ¯</p></li></ul> <p>é…ç½®æ–‡ä»¶<code>config.dart</code>è®°å½•é€šç”¨ä¿¡æ¯ï¼š</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">enum</span> <span class="token class-name">Env</span> <span class="token punctuation">{</span> <span class="token class-name">Dev</span><span class="token punctuation">,</span> <span class="token class-name">Prod</span> <span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Config</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token class-name">String</span> baseUrl <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'http://192.168.31.132:3000'</span></span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token class-name">String</span> wsUrl <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'ws://192.168.31.132:3001'</span></span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token class-name">Env</span> env <span class="token operator">=</span> <span class="token class-name">Env.Dev</span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token class-name">String</span> publicDBName <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'public.db'</span></span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token class-name">String</span> privateDBName <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'private.db'</span></span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token class-name">String</span> channelId <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'com.toimc.community.im'</span></span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token class-name">String</span> channelName <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'toimcæŠ€æœ¯ç¤¾åŒº'</span></span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token class-name">String</span> channelDesc <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'toimcæŠ€æœ¯ç¤¾åŒºæ¶ˆæ¯'</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ–°å»ºä¸€ä¸ªå·¥å…·ç±»æ–‡ä»¶<code>utils/notifications_utils.dart</code>ï¼š</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token comment">// ignore_for_file: close_sinks</span>

<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'dart:async'</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:flutter_local_notifications/flutter_local_notifications.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:my_app/config.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:my_app/entity/msg/received_notification.dart'</span></span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">NotificationsUtils</span> <span class="token punctuation">{</span>
  <span class="token comment">// åˆå§‹åŒ–plugins</span>
  <span class="token class-name">FlutterLocalNotificationsPlugin</span> flutterLocalNotificationsPlugin <span class="token operator">=</span>
      <span class="token class-name">FlutterLocalNotificationsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">final</span> <span class="token class-name">StreamController</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ReceivedNotification</span><span class="token punctuation">&gt;</span></span>
      didReceiveLocalNotificationStream <span class="token operator">=</span>
      <span class="token class-name">StreamController</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ReceivedNotification</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">final</span> <span class="token class-name">StreamController</span> selectNotificationStream <span class="token operator">=</span> <span class="token class-name">StreamController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// åˆå§‹åŒ–æ¶ˆæ¯</span>
  <span class="token function">initNotifications</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
    <span class="token comment">// è®¾ç½®android icon</span>
    <span class="token keyword">const</span> <span class="token class-name">AndroidInitializationSettings</span> initializationSettingsAndroid <span class="token operator">=</span>
        <span class="token class-name">AndroidInitializationSettings</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'@mipmap/ic_launcher'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è¯·æ±‚æƒé™</span>
    <span class="token keyword">final</span> <span class="token class-name">IOSInitializationSettings</span> initializationSettingsIOS <span class="token operator">=</span>
        <span class="token class-name">IOSInitializationSettings</span><span class="token punctuation">(</span>
      requestSoundPermission<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      requestBadgePermission<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      requestAlertPermission<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token comment">// æ¥æ”¶æ¶ˆæ¯å›è°ƒ</span>
      onDidReceiveLocalNotification<span class="token punctuation">:</span> onDidReceiveLocalNotification<span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> <span class="token class-name">MacOSInitializationSettings</span> initializationSettingsMacOS <span class="token operator">=</span>
        <span class="token class-name">MacOSInitializationSettings</span><span class="token punctuation">(</span>
            requestAlertPermission<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            requestBadgePermission<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            requestSoundPermission<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> <span class="token class-name">InitializationSettings</span> initializationSettings <span class="token operator">=</span>
        <span class="token class-name">InitializationSettings</span><span class="token punctuation">(</span>
            android<span class="token punctuation">:</span> initializationSettingsAndroid<span class="token punctuation">,</span>
            iOS<span class="token punctuation">:</span> initializationSettingsIOS<span class="token punctuation">,</span>
            macOS<span class="token punctuation">:</span> initializationSettingsMacOS<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// æ¶ˆæ¯åˆå§‹åŒ–</span>
    <span class="token keyword">await</span> flutterLocalNotificationsPlugin<span class="token punctuation">.</span><span class="token function">initialize</span><span class="token punctuation">(</span>initializationSettings<span class="token punctuation">,</span>
        <span class="token comment">// ç‚¹å‡»æ¶ˆæ¯çš„å›è°ƒ</span>
        onSelectNotification<span class="token punctuation">:</span> onSelectNotification<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">onDidReceiveLocalNotification</span><span class="token punctuation">(</span>
      int id<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token operator">?</span> title<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token operator">?</span> body<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token operator">?</span> payload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'onDidReceiveLocalNotification payload is ğŸ‘‰ </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">payload</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    didReceiveLocalNotificationStream<span class="token punctuation">.</span>sink<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>
      <span class="token class-name">ReceivedNotification</span><span class="token punctuation">(</span>
        id<span class="token punctuation">:</span> id<span class="token punctuation">,</span>
        title<span class="token punctuation">:</span> title<span class="token punctuation">,</span>
        body<span class="token punctuation">:</span> body<span class="token punctuation">,</span>
        payload<span class="token punctuation">:</span> payload<span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">onSelectNotification</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token operator">?</span> payload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>payload <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'onSelectNotification payload is ğŸ‘‰ </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">payload</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      selectNotificationStream<span class="token punctuation">.</span>sink<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å•ç‹¬å‡ºæ¥çš„iOSè¯·æ±‚æƒé™</span>
  <span class="token function">requestIOSPermissions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
    bool<span class="token operator">?</span> result <span class="token operator">=</span> <span class="token keyword">await</span> flutterLocalNotificationsPlugin
        <span class="token punctuation">.</span>resolvePlatformSpecificImplementation<span class="token generics"><span class="token punctuation">&lt;</span>
            <span class="token class-name">IOSFlutterLocalNotificationsPlugin</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">requestPermissions</span><span class="token punctuation">(</span>
          alert<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          badge<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          sound<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// å•ç‹¬å‡ºæ¥çš„MacOSè¯·æ±‚æƒé™</span>
  <span class="token function">requestMacOSPermissions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
    bool<span class="token operator">?</span> result <span class="token operator">=</span> <span class="token keyword">await</span> flutterLocalNotificationsPlugin
        <span class="token punctuation">.</span>resolvePlatformSpecificImplementation<span class="token generics"><span class="token punctuation">&lt;</span>
            <span class="token class-name">MacOSFlutterLocalNotificationsPlugin</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">requestPermissions</span><span class="token punctuation">(</span>
          alert<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          badge<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          sound<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// æ˜¾ç¤º æ¶ˆæ¯</span>
  <span class="token keyword">show</span><span class="token punctuation">(</span><span class="token class-name">ReceivedNotification</span> receivedNotification<span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token class-name">AndroidNotificationDetails</span> androidPlatformChannelSpecifics <span class="token operator">=</span>
        <span class="token class-name">AndroidNotificationDetails</span><span class="token punctuation">(</span><span class="token class-name">Config</span><span class="token punctuation">.</span>channelId<span class="token punctuation">,</span> <span class="token class-name">Config</span><span class="token punctuation">.</span>channelName<span class="token punctuation">,</span>
            channelDescription<span class="token punctuation">:</span> <span class="token class-name">Config</span><span class="token punctuation">.</span>channelDesc<span class="token punctuation">,</span>
            importance<span class="token punctuation">:</span> <span class="token class-name">Importance</span><span class="token punctuation">.</span>max<span class="token punctuation">,</span>
            priority<span class="token punctuation">:</span> <span class="token class-name">Priority</span><span class="token punctuation">.</span>high<span class="token punctuation">,</span>
            ticker<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'ticker'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token class-name">NotificationDetails</span> platformChannelSpecifics <span class="token operator">=</span>
        <span class="token class-name">NotificationDetails</span><span class="token punctuation">(</span>android<span class="token punctuation">:</span> androidPlatformChannelSpecifics<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> flutterLocalNotificationsPlugin<span class="token punctuation">.</span><span class="token keyword">show</span><span class="token punctuation">(</span>
      receivedNotification<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
      receivedNotification<span class="token punctuation">.</span>title<span class="token punctuation">,</span>
      receivedNotification<span class="token punctuation">.</span>body<span class="token punctuation">,</span>
      platformChannelSpecifics<span class="token punctuation">,</span>
      payload<span class="token punctuation">:</span> receivedNotification<span class="token punctuation">.</span>payload<span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// é’ˆå¯¹ dart ä¸­çš„streamè¿›è¡Œæ€§èƒ½ä¸Šçš„ä¼˜åŒ–ï¼Œå›æ”¶å†…å­˜</span>
  <span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    didReceiveLocalNotificationStream<span class="token punctuation">.</span>sink<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    selectNotificationStream<span class="token punctuation">.</span>sink<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åœ¨å…¨å±€<code>get_it</code>è¿›è¡Œå®ä¾‹åŒ–ï¼š</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token comment">// ...</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:my_app/utils/notifications_utils.dart'</span></span><span class="token punctuation">;</span>

<span class="token keyword">final</span> getIt <span class="token operator">=</span> <span class="token class-name">GetIt</span><span class="token punctuation">.</span>instance<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">setupGetIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  getIt<span class="token punctuation">.</span>registerSingleton<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">NotificationsUtils</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">NotificationsUtils</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="å¦‚ä½•æµ‹è¯•å‘¢"><a href="#å¦‚ä½•æµ‹è¯•å‘¢" class="header-anchor">#</a> å¦‚ä½•æµ‹è¯•å‘¢ï¼Ÿ</h3> <p>æ¶ˆæ¯æ˜¯å¼‚æ­¥çš„ï¼Œå¯ä»¥åœ¨<code>main.dart</code>ä¸­è¿›è¡Œæµ‹è¯•ï¼š</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
  <span class="token function">setupGetIt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// getIt.registerSingleton&lt;WebSocketUtils&gt;(WebSocketUtils(Config.wsUrl));</span>
  <span class="token comment">// WebSocketUtils webSocketUtils = getIt&lt;WebSocketUtils&gt;();</span>
  <span class="token class-name">NotificationsUtils</span> notificationsUtils <span class="token operator">=</span> getIt<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">NotificationsUtils</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// è¯·æ±‚æ¶ˆæ¯æƒé™</span>
  <span class="token class-name">Timer</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">(</span>seconds<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> notificationsUtils<span class="token punctuation">.</span><span class="token function">requestIOSPermissions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> notificationsUtils<span class="token punctuation">.</span><span class="token function">initNotifications</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> notificationsUtils<span class="token punctuation">.</span><span class="token keyword">show</span><span class="token punctuation">(</span><span class="token class-name">ReceivedNotification</span><span class="token punctuation">(</span>
        id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        title<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'æµ‹è¯•æ¶ˆæ¯çš„title'</span></span><span class="token punctuation">,</span>
        body<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'æµ‹è¯•æ¶ˆæ¯çš„body'</span></span><span class="token punctuation">,</span> <span class="token comment">// payloadéƒ¨åˆ†ä¼šåŒ…å«titleä¸bodyï¼Œå¹¶ä¸”ä¼šä¼ é€’typeç±»å‹</span>
        <span class="token comment">// å¾®ä¿¡ -&gt; å›¾ç‰‡ -&gt; [å›¾ç‰‡]</span>
        <span class="token comment">// 1.type è§£æ</span>
        <span class="token comment">// 2.downloadå›¾ç‰‡ -&gt; ç¼©ç•¥å›¾</span>
        <span class="token comment">// 3.ç‚¹å‡»å›¾ç‰‡ -&gt;</span>
        payload<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;{'title':'mytest', 'body': 'mybody'}...&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    notificationsUtils<span class="token punctuation">.</span>selectNotificationStream<span class="token punctuation">.</span>stream<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'event is ğŸ‘‰ </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">event</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">runApp</span><span class="token punctuation">(</span><span class="token class-name">MyApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="å£°éŸ³ä¸éœ‡åŠ¨"><a href="#å£°éŸ³ä¸éœ‡åŠ¨" class="header-anchor">#</a> å£°éŸ³ä¸éœ‡åŠ¨</h3> <p>éœ‡åŠ¨éœ€è¦ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“è¿›è¡Œæ”¯æŒï¼š</p> <div class="language-dart extra-class"><pre class="language-dart"><code>dependencies<span class="token punctuation">:</span>
  # éœ‡åŠ¨
  vibration<span class="token punctuation">:</span> <span class="token operator">^</span><span class="token number">1.7</span><span class="token number">.4</span><span class="token operator">-</span>nullsafety<span class="token punctuation">.</span><span class="token number">0</span>
</code></pre></div><p>åœ¨Storageä¸­å…¨å±€å­˜å‚¨æ¶ˆæ¯çš„é™éŸ³ä¸å£°éŸ³ï¼ˆåŒç†ï¼Œä¹Ÿå¯ä»¥é’ˆå¯¹ä¸åŒçš„ç”¨æˆ·è¿›è¡Œå­˜å‚¨ï¼‰ï¼š</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:get_storage/get_storage.dart'</span></span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>

<span class="token keyword">enum</span> <span class="token class-name">StoreKeys</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  isMute<span class="token punctuation">,</span>
  isVibrate<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Storage</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token class-name">Storage</span> _storage <span class="token operator">=</span> <span class="token class-name">Storage</span><span class="token punctuation">.</span><span class="token function">_internal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">final</span> <span class="token class-name">GetStorage</span> _box <span class="token operator">=</span> <span class="token class-name">GetStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token class-name">GetStorage</span> <span class="token keyword">get</span> box <span class="token operator">=</span><span class="token operator">&gt;</span> _box<span class="token punctuation">;</span>

  <span class="token class-name">Storage</span><span class="token punctuation">.</span><span class="token function">_internal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">factory</span> <span class="token class-name">Storage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> _storage<span class="token punctuation">;</span>

  <span class="token comment">// common set &amp; get</span>
  <span class="token keyword">void</span> write<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">StoreKeys</span> key<span class="token punctuation">,</span> <span class="token class-name">T</span> value<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> _box<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>key<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token class-name">T</span> read<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">StoreKeys</span> key<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> _box<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>key<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// setToken, getToken</span>
  <span class="token function">setToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> token<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> _box<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token class-name">StoreKeys</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> token<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">String</span><span class="token operator">?</span> <span class="token function">getToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> _box<span class="token punctuation">.</span>read<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">StoreKeys</span><span class="token punctuation">.</span>token<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>éœ€è¦è°ƒæ•´<code>show</code>æ–¹æ³•æ—¶å€™çš„é€»è¾‘ï¼š</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token comment">// æ˜¾ç¤º æ¶ˆæ¯</span>
<span class="token keyword">show</span><span class="token punctuation">(</span><span class="token class-name">ReceivedNotification</span> receivedNotification<span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
  <span class="token comment">// isMute false-æœ‰å£°éŸ³ï¼Œ true-é™éŸ³</span>
  bool isMute <span class="token operator">=</span> <span class="token class-name">Storage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token class-name">StoreKeys</span><span class="token punctuation">.</span>isMute<span class="token punctuation">)</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token comment">// isVibrate æ§åˆ¶éœ‡åŠ¨</span>
  bool isVibrate <span class="token operator">=</span> <span class="token class-name">Storage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token class-name">StoreKeys</span><span class="token punctuation">.</span>isVibrate<span class="token punctuation">)</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token class-name">AndroidNotificationDetails</span> androidPlatformChannelSpecifics <span class="token operator">=</span>
    <span class="token class-name">AndroidNotificationDetails</span><span class="token punctuation">(</span>
    <span class="token class-name">Config</span><span class="token punctuation">.</span>channelId<span class="token punctuation">,</span>
    <span class="token class-name">Config</span><span class="token punctuation">.</span>channelName<span class="token punctuation">,</span>
    channelDescription<span class="token punctuation">:</span> <span class="token class-name">Config</span><span class="token punctuation">.</span>channelDesc<span class="token punctuation">,</span>
    importance<span class="token punctuation">:</span> <span class="token class-name">Importance</span><span class="token punctuation">.</span>max<span class="token punctuation">,</span>
    priority<span class="token punctuation">:</span> <span class="token class-name">Priority</span><span class="token punctuation">.</span>high<span class="token punctuation">,</span>
    ticker<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'ticker'</span></span><span class="token punctuation">,</span>
    playSound<span class="token punctuation">:</span> <span class="token operator">!</span>isMute<span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">IOSNotificationDetails</span> iosNotificationDetails <span class="token operator">=</span>
    <span class="token class-name">IOSNotificationDetails</span><span class="token punctuation">(</span>presentSound<span class="token punctuation">:</span> <span class="token operator">!</span>isMute<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">NotificationDetails</span> platformChannelSpecifics <span class="token operator">=</span> <span class="token class-name">NotificationDetails</span><span class="token punctuation">(</span>
    android<span class="token punctuation">:</span> androidPlatformChannelSpecifics<span class="token punctuation">,</span> iOS<span class="token punctuation">:</span> iosNotificationDetails<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> flutterLocalNotificationsPlugin<span class="token punctuation">.</span><span class="token keyword">show</span><span class="token punctuation">(</span>
    receivedNotification<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
    receivedNotification<span class="token punctuation">.</span>title<span class="token punctuation">,</span>
    receivedNotification<span class="token punctuation">.</span>body<span class="token punctuation">,</span>
    platformChannelSpecifics<span class="token punctuation">,</span>
    payload<span class="token punctuation">:</span> receivedNotification<span class="token punctuation">.</span>payload<span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isVibrate <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token class-name">Vibration</span><span class="token punctuation">.</span><span class="token function">hasVibrator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// éœ‡åŠ¨</span>
    <span class="token class-name">Vibration</span><span class="token punctuation">.</span><span class="token function">vibrate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="é¦–é¡µå¯¼èˆª"><a href="#é¦–é¡µå¯¼èˆª" class="header-anchor">#</a> é¦–é¡µå¯¼èˆª</h2> <h3 id="å±å¹•é€‚é…"><a href="#å±å¹•é€‚é…" class="header-anchor">#</a> å±å¹•é€‚é…</h3> <p><strong>flutter å±å¹•é€‚é…æ–¹æ¡ˆï¼Œè®©UIåœ¨ä¸åŒå°ºå¯¸çš„å±å¹•ä¸Šéƒ½èƒ½æ˜¾ç¤ºåˆç†çš„å¸ƒå±€!</strong></p> <p>ä¾èµ–é¡¹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>dependencies:
  flutter_screenutil: ^5.1.1
</code></pre></div><p>å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ï¼š<a href="https://github.com/OpenFlutter/flutter_screenutil/blob/master/README_CN.md" target="_blank" rel="noopener noreferrer">https://github.com/OpenFlutter/flutter_screenutil/blob/master/README_CN.md<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>åŸºç¡€çš„æ¦‚å¿µï¼š</p> <table><thead><tr><th>å±æ€§</th> <th>ç±»å‹</th> <th>é»˜è®¤å€¼</th> <th>æè¿°</th></tr></thead> <tbody><tr><td>designSize</td> <td>Size</td> <td>Size(360, 690)</td> <td>è®¾è®¡ç¨¿ä¸­è®¾å¤‡çš„å°ºå¯¸(<strong>å•ä½éšæ„,å»ºè®®dp,ä½†åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å¿…é¡»ä¿æŒä¸€è‡´</strong>)</td></tr> <tr><td>builder</td> <td>Widget Function()</td> <td>Container()</td> <td>ä¸€èˆ¬è¿”å›ä¸€ä¸ªMaterialAppç±»å‹çš„Function()</td></tr> <tr><td>orientation</td> <td>Orientation</td> <td>portrait</td> <td>å±å¹•æ–¹å‘</td></tr> <tr><td>splitScreenMode</td> <td>bool</td> <td>true</td> <td>æ”¯æŒåˆ†å±å°ºå¯¸</td></tr> <tr><td>minTextAdapt</td> <td>bool</td> <td>false</td> <td>æ˜¯å¦æ ¹æ®å®½åº¦/é«˜åº¦ä¸­çš„æœ€å°å€¼é€‚é…æ–‡å­—</td></tr> <tr><td>context</td> <td>BuildContext</td> <td>null</td> <td>ä¼ å…¥contextä¼šæ›´çµæ•çš„æ ¹æ®å±å¹•å˜åŒ–è€Œæ”¹å˜</td></tr></tbody></table> <p>å…³äºè®¾è®¡å°ºå¯¸ï¼Œä¸€èˆ¬æ˜¯2xçš„è®¾è®¡å°ºå¯¸ï¼š</p> <p><img src="/notes-page/assets/img/image-20220129105243936.ccc5cf4e.png" alt="image-20220129105243936"></p> <p>åˆå§‹åŒ–ï¼Œä¿®æ”¹<code>main.dart</code>æ–‡ä»¶ï¼š</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">class</span> <span class="token class-name">MyApp</span> <span class="token keyword">extends</span> <span class="token class-name">StatelessWidget</span> <span class="token punctuation">{</span>
  <span class="token metadata function">@override</span>
  <span class="token class-name">Widget</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">MaterialApp</span><span class="token punctuation">(</span>
      debugShowCheckedModeBanner<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      title<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'Flutter_ScreenUtil'</span></span><span class="token punctuation">,</span>
      theme<span class="token punctuation">:</span> <span class="token class-name">ThemeData</span><span class="token punctuation">(</span>
        primarySwatch<span class="token punctuation">:</span> <span class="token class-name">Colors</span><span class="token punctuation">.</span>blue<span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
      home<span class="token punctuation">:</span> <span class="token class-name">HomePage</span><span class="token punctuation">(</span>title<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'FlutterScreenUtil Demo'</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">HomePage</span> <span class="token keyword">extends</span> <span class="token class-name">StatefulWidget</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token class-name">HomePage</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">Key</span> key<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">super</span><span class="token punctuation">(</span>key<span class="token punctuation">:</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">final</span> <span class="token class-name">String</span> title<span class="token punctuation">;</span>

  <span class="token metadata function">@override</span>
  _HomePageState <span class="token function">createState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">_HomePageState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> _HomePageState <span class="token keyword">extends</span> <span class="token class-name">State</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HomePage</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
  <span class="token metadata function">@override</span>
  <span class="token class-name">Widget</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//è®¾ç½®å°ºå¯¸ï¼ˆå¡«å†™è®¾è®¡ä¸­è®¾å¤‡çš„å±å¹•å°ºå¯¸ï¼‰å¦‚æœè®¾è®¡åŸºäº360dp * 690dpçš„å±å¹•</span>
    <span class="token class-name">ScreenUtil</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>
        <span class="token class-name">BoxConstraints</span><span class="token punctuation">(</span>
            maxWidth<span class="token punctuation">:</span> <span class="token class-name">MediaQuery</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">.</span>width<span class="token punctuation">,</span>
            maxHeight<span class="token punctuation">:</span> <span class="token class-name">MediaQuery</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">,</span>
        designSize<span class="token punctuation">:</span> <span class="token class-name">Size</span><span class="token punctuation">(</span><span class="token number">360</span><span class="token punctuation">,</span> <span class="token number">690</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        context<span class="token punctuation">:</span> context<span class="token punctuation">,</span>
        minTextAdapt<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        orientation<span class="token punctuation">:</span> <span class="token class-name">Orientation</span><span class="token punctuation">.</span>portrait<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">Scaffold</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>ScreenUtil.initåªéœ€åœ¨homeæˆ–è€…æ ¹è·¯ç”±ï¼ˆå³ç¬¬ä¸€ä¸ªflutteré¡µé¢ï¼‰ä¸­è°ƒç”¨ä¸€æ¬¡å³å¯ã€‚</strong></p> <blockquote><p>æ³¨æ„ï¼šä¸æ”¯æŒåœ¨<code>MaterialApp</code>çš„<code>theme</code>çš„<code>textTheme</code>ä¸­ä½¿ç”¨å­—ä½“é€‚é…ã€‚â€”â€”éå¸¸å¥½ç†è§£ï¼Œé‚£æ—¶å€™è¯¥æ’ä»¶è¿˜æœªåˆå§‹åŒ–å®Œæˆã€‚</p></blockquote> <p>å¤§å‰ç«¯çš„é¡¹ç›®ä¸­å¦‚ä½•åˆå§‹åŒ–ï¼š</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token comment">// ...</span>
<span class="token keyword">return</span> <span class="token class-name">MaterialApp</span><span class="token punctuation">.</span><span class="token function">router</span><span class="token punctuation">(</span>
  routeInformationParser<span class="token punctuation">:</span> _rootRouter<span class="token punctuation">.</span><span class="token function">defaultRouteParser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  routerDelegate<span class="token punctuation">:</span> _rootRouter<span class="token punctuation">.</span><span class="token function">delegate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  builder<span class="token punctuation">:</span> <span class="token punctuation">(</span>_<span class="token punctuation">,</span> child<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ScreenUtil</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>
      <span class="token class-name">BoxConstraints</span><span class="token punctuation">(</span>
        maxWidth<span class="token punctuation">:</span> <span class="token class-name">MediaQuery</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">.</span>width<span class="token punctuation">,</span>
        maxHeight<span class="token punctuation">:</span> <span class="token class-name">MediaQuery</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">,</span>
      designSize<span class="token punctuation">:</span> <span class="token class-name">Size</span><span class="token punctuation">(</span><span class="token number">750</span><span class="token punctuation">,</span> <span class="token number">1334</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token comment">// é»˜è®¤çš„å±å¹•æ–¹å‘</span>
      orientation<span class="token punctuation">:</span> <span class="token class-name">Orientation</span><span class="token punctuation">.</span>portrait<span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ç¤ºä¾‹ï¼Œé˜²æ­¢è¿”å›null</span>
    <span class="token keyword">return</span> child <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> child <span class="token punctuation">:</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ä½¿ç”¨æ–¹æ³•ï¼š</p> <p>ä¼ å…¥è®¾è®¡ç¨¿çš„dpå°ºå¯¸</p> <div class="language- extra-class"><pre class="language-text"><code>    ScreenUtil().setWidth(540)  (sdk&gt;=2.6 : 540.w)   //æ ¹æ®å±å¹•å®½åº¦é€‚é…å°ºå¯¸
    ScreenUtil().setHeight(200) (sdk&gt;=2.6 : 200.h)   //æ ¹æ®å±å¹•é«˜åº¦é€‚é…å°ºå¯¸(ä¸€èˆ¬æ ¹æ®å®½åº¦é€‚é…å³å¯)
    ScreenUtil().radius(200)    (sdk&gt;=2.6 : 200.r)   //æ ¹æ®å®½åº¦æˆ–é«˜åº¦ä¸­çš„è¾ƒå°è€…è¿›è¡Œè°ƒæ•´
    ScreenUtil().setSp(24)      (sdk&gt;=2.6 : 24.sp)   //é€‚é…å­—ä½“
    12.sm   // å–12å’Œ12.spä¸­çš„æœ€å°å€¼

    ScreenUtil.pixelRatio       //è®¾å¤‡çš„åƒç´ å¯†åº¦
    ScreenUtil.screenWidth   (sdk&gt;=2.6 : 1.sw)   //è®¾å¤‡å®½åº¦
    ScreenUtil.screenHeight  (sdk&gt;=2.6 : 1.sh)   //è®¾å¤‡é«˜åº¦
    ScreenUtil.bottomBarHeight  //åº•éƒ¨å®‰å…¨åŒºè·ç¦»ï¼Œé€‚ç”¨äºå…¨é¢å±ä¸‹é¢æœ‰æŒ‰é”®çš„
    ScreenUtil.statusBarHeight  //çŠ¶æ€æ é«˜åº¦ åˆ˜æµ·å±ä¼šæ›´é«˜
    ScreenUtil.textScaleFactor //ç³»ç»Ÿå­—ä½“ç¼©æ”¾æ¯”ä¾‹

    ScreenUtil().scaleWidth  // å®é™…å®½åº¦è®¾è®¡ç¨¿å®½åº¦çš„æ¯”ä¾‹
    ScreenUtil().scaleHeight // å®é™…é«˜åº¦ä¸è®¾è®¡ç¨¿é«˜åº¦åº¦çš„æ¯”ä¾‹

    ScreenUtil().orientation  //å±å¹•æ–¹å‘

    0.2.sw  //å±å¹•å®½åº¦çš„0.2å€
    0.5.sh  //å±å¹•é«˜åº¦çš„50%
</code></pre></div><p>å¦‚æœFlutterçš„sdkæ˜¯å¤§äºç­‰äº2.6ï¼ˆsdk&gt;=2.6ï¼‰çš„ï¼Œå¯ä»¥ä½¿ç”¨æ‰©å±•å‡½æ•°ï¼š</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token class-name">Container</span><span class="token punctuation">(</span>
  width<span class="token punctuation">:</span> <span class="token number">50.</span>w<span class="token punctuation">,</span>
  height<span class="token punctuation">:</span><span class="token number">200.</span>h
<span class="token punctuation">)</span>
</code></pre></div><p>ç­‰ä»·ï¼š</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token class-name">Container</span><span class="token punctuation">(</span>
  width<span class="token punctuation">:</span> <span class="token class-name">ScreenUtil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setWidth</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  height<span class="token punctuation">:</span><span class="token class-name">ScreenUtil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setHeight</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre></div><p>ç®€æ´äº†å¥½å¤šã€‚</p> <h3 id="åº•éƒ¨å¯¼èˆª"><a href="#åº•éƒ¨å¯¼èˆª" class="header-anchor">#</a> åº•éƒ¨å¯¼èˆª</h3> <p>æœ¬èŠ‚å®Œæˆçš„æœ€ç»ˆæ•ˆæœï¼š</p> <p><img src="/notes-page/assets/img/image-20220129110146158.d2ef885c.png" alt="image-20220129110146158"></p> <p>æ­¥éª¤ï¼š</p> <ul><li><p>å‡çº§auto_routeè‡³3.xçš„ç‰ˆæœ¬ï¼š</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">dependencies</span><span class="token punctuation">:</span>
  <span class="token comment"># ...</span>
  <span class="token comment"># è‡ªåŠ¨è·¯ç”±</span>
  <span class="token key atrule">auto_route</span><span class="token punctuation">:</span> ^3.0.1

<span class="token key atrule">dev_dependencies</span><span class="token punctuation">:</span>
  <span class="token comment"># ...</span>
  <span class="token comment"># è‡ªåŠ¨è·¯ç”±</span>
  <span class="token key atrule">auto_route_generator</span><span class="token punctuation">:</span> ^3.0.1
</code></pre></div></li> <li><p>æ–°å»º4ä¸ªæµ‹è¯•é¡µé¢é¦–é¡µã€æ¶ˆæ¯ã€çƒ­é—¨ã€æˆ‘çš„ï¼š</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:flutter/material.dart'</span></span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">HomePage</span> <span class="token keyword">extends</span> <span class="token class-name">StatelessWidget</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token class-name">HomePage</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">Key</span><span class="token operator">?</span> key<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">super</span><span class="token punctuation">(</span>key<span class="token punctuation">:</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token metadata function">@override</span>
  <span class="token class-name">Widget</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">Container</span><span class="token punctuation">(</span>
      child<span class="token punctuation">:</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'HomePage'</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>åˆ›å»ºé¦–é¡µçš„<code>routes.dart</code>é¡µé¢</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:auto_route/auto_route.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:my_app/pages/home/detail_page.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:my_app/pages/home/home_page.dart'</span></span><span class="token punctuation">;</span>

<span class="token keyword">const</span> homeTab <span class="token operator">=</span> <span class="token class-name">AutoRoute</span><span class="token punctuation">(</span>
  path<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'home'</span></span><span class="token punctuation">,</span>
  page<span class="token punctuation">:</span> <span class="token class-name">EmptyRouterPage</span><span class="token punctuation">,</span>
  name<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'HomeTab'</span></span><span class="token punctuation">,</span>
  initial<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token class-name">AutoRoute</span><span class="token punctuation">(</span>
      path<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">''</span></span><span class="token punctuation">,</span>
      page<span class="token punctuation">:</span> <span class="token class-name">HomePage</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">AutoRoute</span><span class="token punctuation">(</span>
      path<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">':id'</span></span><span class="token punctuation">,</span>
      page<span class="token punctuation">:</span> <span class="token class-name">DetailPage</span><span class="token punctuation">,</span>
      meta<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string-literal"><span class="token string">'hideBottomNav'</span></span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>è¯´æ˜ï¼šå¤šé¡µé¢çš„è·¯ç”±ï¼Œå¯ä»¥å†™åœ¨ç»Ÿä¸€çš„æ–‡ä»¶å¤¹ä¸‹ï¼Œä¹Ÿå¯ä»¥å†™åœ¨å„ä¸ªæ–‡ä»¶ä¸­ï¼Œæ ¹æ®è‡ªå·±çš„å–œå¥½æ¥å®šã€‚</p></blockquote> <p><img src="/notes-page/assets/img/image-20220129112421209.faf10800.png" alt="image-20220129112421209"></p></li> <li><p>æ€»è·¯ç”±æ–‡ä»¶<code>routes/routes.dart</code>ï¼š</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:auto_route/auto_route.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:my_app/pages/center/center_page.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:my_app/pages/center/routes.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:my_app/pages/center/settings_page.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:my_app/pages/home/home_page.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:my_app/pages/home/routes.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:my_app/pages/hot/hot_page.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:my_app/pages/hot/routes.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:my_app/pages/login_view.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:my_app/pages/msg/msg_page.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:my_app/pages/msg/routes.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:my_app/pages/root_view.dart'</span></span><span class="token punctuation">;</span>

<span class="token metadata function">@AdaptiveAutoRouter</span><span class="token punctuation">(</span>
  routes<span class="token punctuation">:</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AutoRoute</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span>
    <span class="token class-name">AutoRoute</span><span class="token punctuation">(</span>
      page<span class="token punctuation">:</span> <span class="token class-name">RootView</span><span class="token punctuation">,</span>
      path<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;/&quot;</span></span><span class="token punctuation">,</span>
      children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        homeTab<span class="token punctuation">,</span> <span class="token comment">// è¿™ä¸ªå…¶å®æœ‰ç‚¹åƒåµŒå¥—è·¯ç”±ï¼Ÿæ˜¯å§ï¼</span>
        msgTab<span class="token punctuation">,</span>
        hotTab<span class="token punctuation">,</span>
        centerTab<span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">AutoRoute</span><span class="token punctuation">(</span>page<span class="token punctuation">:</span> <span class="token class-name">LoginView</span><span class="token punctuation">,</span> path<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;/login&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// AutoRoute(page: HomeView, path: &quot;/home-view/:id&quot;, guards: [AuthGuard]),</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
<span class="token keyword">class</span> $<span class="token class-name">AppRouter</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div></li> <li><p>ä¿®æ”¹<code>root_view.dart</code>æ–‡ä»¶ï¼š</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:auto_route/auto_route.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:flutter/material.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:flutter_screenutil/flutter_screenutil.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:my_app/routes/routes.gr.dart'</span></span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">RootView</span> <span class="token keyword">extends</span> <span class="token class-name">StatelessWidget</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token class-name">RootView</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token class-name">Key</span><span class="token operator">?</span> key<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">super</span><span class="token punctuation">(</span>key<span class="token punctuation">:</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token metadata function">@override</span>
  <span class="token class-name">Widget</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">WillPopScope</span><span class="token punctuation">(</span>
      onWillPop<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      child<span class="token punctuation">:</span> <span class="token class-name">AutoTabsScaffold</span><span class="token punctuation">(</span>
        appBarBuilder<span class="token punctuation">:</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span> tabsRouter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// è¿™é‡Œçš„AutoBackButtonä¹Ÿæ˜¯ä¸€ä¸ªauto_routeçš„ç»„ä»¶</span>
          <span class="token keyword">return</span> <span class="token class-name">AppBar</span><span class="token punctuation">(</span>
              title<span class="token punctuation">:</span> <span class="token class-name">Text</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>topRoute<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> leading<span class="token punctuation">:</span> <span class="token class-name">AutoBackButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        routes<span class="token punctuation">:</span> <span class="token punctuation">[</span>
          <span class="token class-name">HomeTab</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token class-name">MsgTab</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token class-name">HotTab</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token class-name">CenterTab</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        bottomNavigationBuilder<span class="token punctuation">:</span> buildBottomNav<span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token class-name">Widget</span> <span class="token function">buildBottomNav</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">,</span> <span class="token class-name">TabsRouter</span> tabsRouter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ§åˆ¶åº•éƒ¨æ˜¯å¦æ˜¾ç¤º -&gt; æœ‰ç‚¹åƒä¼ä¸šå¾®ä¿¡ã€é’‰é’‰ç­‰åº”ç”¨</span>
    <span class="token keyword">final</span> hideBottomNav <span class="token operator">=</span> context<span class="token punctuation">.</span>topRouteMatch<span class="token punctuation">.</span>meta<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">'hideBottomNav'</span></span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> hideBottomNav
        <span class="token operator">?</span> <span class="token class-name">SizedBox</span><span class="token punctuation">.</span><span class="token function">shrink</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">:</span> <span class="token class-name">BottomNavigationBar</span><span class="token punctuation">(</span>
            currentIndex<span class="token punctuation">:</span> tabsRouter<span class="token punctuation">.</span>activeIndex<span class="token punctuation">,</span>
            onTap<span class="token punctuation">:</span> tabsRouter<span class="token punctuation">.</span>setActiveIndex<span class="token punctuation">,</span>
            <span class="token comment">// è¿™é‡Œæ˜¯æ§åˆ¶åˆ‡æ¢çš„ç¼©æ”¾æ•ˆæœ</span>
            type<span class="token punctuation">:</span> <span class="token class-name">BottomNavigationBarType</span><span class="token punctuation">.</span>fixed<span class="token punctuation">,</span>
            <span class="token comment">// ä½¿ç”¨å‰ç½®çš„é€‚é…æ–¹æ¡ˆscreenutil</span>
            selectedFontSize<span class="token punctuation">:</span> <span class="token number">22.</span>sp<span class="token punctuation">,</span>
            unselectedFontSize<span class="token punctuation">:</span> <span class="token number">22.</span>sp<span class="token punctuation">,</span>
            selectedItemColor<span class="token punctuation">:</span> <span class="token class-name">Colors</span><span class="token punctuation">.</span>red<span class="token punctuation">,</span>
            items<span class="token punctuation">:</span> <span class="token punctuation">[</span>
              <span class="token class-name">BottomNavigationBarItem</span><span class="token punctuation">(</span>
                icon<span class="token punctuation">:</span> <span class="token class-name">Icon</span><span class="token punctuation">(</span><span class="token class-name">Icons</span><span class="token punctuation">.</span>home<span class="token punctuation">)</span><span class="token punctuation">,</span>
                backgroundColor<span class="token punctuation">:</span> <span class="token class-name">Colors</span><span class="token punctuation">.</span>black<span class="token punctuation">,</span>
                label<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'é¦–é¡µ'</span></span><span class="token punctuation">,</span>
              <span class="token punctuation">)</span><span class="token punctuation">,</span>
              <span class="token class-name">BottomNavigationBarItem</span><span class="token punctuation">(</span>
                icon<span class="token punctuation">:</span> <span class="token class-name">Icon</span><span class="token punctuation">(</span><span class="token class-name">Icons</span><span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">,</span>
                label<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'æ¶ˆæ¯'</span></span><span class="token punctuation">,</span>
              <span class="token punctuation">)</span><span class="token punctuation">,</span>
              <span class="token class-name">BottomNavigationBarItem</span><span class="token punctuation">(</span>
                icon<span class="token punctuation">:</span> <span class="token class-name">Icon</span><span class="token punctuation">(</span><span class="token class-name">Icons</span><span class="token punctuation">.</span>hot_tub<span class="token punctuation">)</span><span class="token punctuation">,</span>
                label<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'çƒ­é—¨'</span></span><span class="token punctuation">,</span>
              <span class="token punctuation">)</span><span class="token punctuation">,</span>
              <span class="token class-name">BottomNavigationBarItem</span><span class="token punctuation">(</span>
                icon<span class="token punctuation">:</span> <span class="token class-name">Icon</span><span class="token punctuation">(</span><span class="token class-name">Icons</span><span class="token punctuation">.</span>person<span class="token punctuation">)</span><span class="token punctuation">,</span>
                label<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'æˆ‘çš„'</span></span><span class="token punctuation">,</span>
              <span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <h3 id="ä¸‹æ‹‰åˆ·æ–°-ä¸Šæ‹‰åŠ è½½"><a href="#ä¸‹æ‹‰åˆ·æ–°-ä¸Šæ‹‰åŠ è½½" class="header-anchor">#</a> ä¸‹æ‹‰åˆ·æ–°ï¼ˆä¸Šæ‹‰åŠ è½½ï¼‰</h3> <p>ä¸‹æ‹‰åˆ·æ–°æ˜¯ç§»åŠ¨ç«¯åº”ç”¨ä¸­æœ€æ™®é€šã€æœ€å¸¸è§çš„åœºæ™¯ï¼Œæ¨èçš„ç¬¬ä¸‰æ–¹åº“æœ‰ï¼š</p> <ul><li>pull_to_refreshï¼ˆæ¨èï¼‰</li> <li>flutter_easyrefresh</li></ul> <p>å®ƒä»¬éƒ½æœ‰ä¸­æ–‡çš„æ–‡æ¡£ï¼Œä¸‹é¢æ¥çœ‹çœ‹å¦‚ä½•å®ç°é¦–é¡µåˆ—è¡¨çš„ä¸‹æ‹‰åˆ·æ–°ï¼š</p> <p>å®‰è£…ä¾èµ–</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">dependencies</span><span class="token punctuation">:</span>
  <span class="token comment"># ä¸‹æ‹‰åˆ·æ–° + ä¸Šæ‹‰åŠ è½½</span>
  <span class="token key atrule">pull_to_refresh</span><span class="token punctuation">:</span> ^2.0.0
</code></pre></div><p>åŸºæœ¬ä½¿ç”¨ï¼Œè°ƒæ•´<code>lib/pages/home/home_page.dart</code></p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'dart:async'</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:flutter/cupertino.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:flutter/material.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:my_app/entity/content/post.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:my_app/services/content_service.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:my_app/setup_get_it.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:pull_to_refresh/pull_to_refresh.dart'</span></span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">HomePage</span> <span class="token keyword">extends</span> <span class="token class-name">StatefulWidget</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token class-name">HomePage</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token class-name">Key</span><span class="token operator">?</span> key<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">super</span><span class="token punctuation">(</span>key<span class="token punctuation">:</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token metadata function">@override</span>
  <span class="token class-name">State</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HomePage</span><span class="token punctuation">&gt;</span></span> <span class="token function">createState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">_HomePageState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> _HomePageState <span class="token keyword">extends</span> <span class="token class-name">State</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HomePage</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
  <span class="token class-name">ContentService</span> contentService <span class="token operator">=</span> getIt<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ContentService</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> items <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;1&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;2&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;3&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;4&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;5&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;6&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;7&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">&quot;8&quot;</span></span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token class-name">RefreshController</span> _refreshController <span class="token operator">=</span>
      <span class="token class-name">RefreshController</span><span class="token punctuation">(</span>initialRefresh<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Post</span><span class="token punctuation">&gt;</span></span><span class="token operator">?</span> _lists<span class="token punctuation">;</span>

  <span class="token metadata function">@override</span>
  <span class="token keyword">void</span> <span class="token function">initState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">initState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// æ–¹æ³•ä¸€ï¼šTimer</span>
    <span class="token class-name">Timer</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span>zero<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
      _lists <span class="token operator">=</span> <span class="token keyword">await</span> contentService<span class="token punctuation">.</span><span class="token function">getPostList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token class-name">Widget</span><span class="token operator">?</span> body<span class="token punctuation">;</span>

  <span class="token keyword">void</span> <span class="token function">_onRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¾€å¤´éƒ¨åŠ æ•°æ®</span>
    <span class="token comment">// newDataæ•°æ®åº“è¯·æ±‚å›æ¥çš„æ•°æ®</span>
    <span class="token comment">// _lists = &lt;Post&gt;[]</span>
    <span class="token comment">//   ..addAll(newData)</span>
    <span class="token comment">//   ..addAll(_lists??[]);</span>
    <span class="token comment">// monitor network fetch</span>
    <span class="token keyword">await</span> <span class="token class-name">Future</span><span class="token punctuation">.</span><span class="token function">delayed</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">(</span>milliseconds<span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// if failed,use refreshFailed()</span>
    <span class="token comment">// å‘Šè¯‰æ’ä»¶å·²ç»åˆ·æ–°å®Œæˆ</span>
    _refreshController<span class="token punctuation">.</span><span class="token function">refreshCompleted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">void</span> <span class="token function">_onLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
    <span class="token comment">// monitor network fetch</span>
    <span class="token keyword">await</span> <span class="token class-name">Future</span><span class="token punctuation">.</span><span class="token function">delayed</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">(</span>milliseconds<span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// åˆ¤æ–­,è¿”å›çš„æ•°ç»„é•¿åº¦ä¸lengthçš„å…³ç³»æ¥å»å†³å®šæ‰§è¡ŒloadNoDatè¿˜æ˜¯loadComplete</span>
    <span class="token comment">// length &lt; limit loadNoData</span>
    <span class="token comment">// length == limit loadComplete</span>
    <span class="token comment">// if failed,use loadFailed(),if no data return,use LoadNodata()</span>
    items<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">(</span>items<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>mounted<span class="token punctuation">)</span> <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    _refreshController<span class="token punctuation">.</span><span class="token function">loadNoData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token metadata function">@override</span>
  <span class="token class-name">Widget</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// pull_to_refreshçš„è‡ªå¸¦ç»„ä»¶ï¼š</span>
    <span class="token keyword">return</span> <span class="token class-name">SmartRefresher</span><span class="token punctuation">(</span>
      enablePullDown<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      enablePullUp<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      header<span class="token punctuation">:</span> <span class="token class-name">WaterDropHeader</span><span class="token punctuation">(</span>
        complete<span class="token punctuation">:</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">// å…³é—­è¿‡æ¸¡æ•ˆæœ</span>
        completeDuration<span class="token punctuation">:</span> <span class="token class-name">Duration</span><span class="token punctuation">.</span>zero<span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
      footer<span class="token punctuation">:</span> <span class="token class-name">CustomFooter</span><span class="token punctuation">(</span>
        <span class="token comment">// è‡ªå®šä¹‰è„šéƒ¨æ˜¾ç¤ºçš„æ–‡å­—</span>
        builder<span class="token punctuation">:</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span> mode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>mode <span class="token operator">==</span> <span class="token class-name">LoadStatus</span><span class="token punctuation">.</span>idle<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            body <span class="token operator">=</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;ä¸Šæ‹‰åŠ è½½&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>mode <span class="token operator">==</span> <span class="token class-name">LoadStatus</span><span class="token punctuation">.</span>loading<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            body <span class="token operator">=</span> <span class="token class-name">CupertinoActivityIndicator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>mode <span class="token operator">==</span> <span class="token class-name">LoadStatus</span><span class="token punctuation">.</span>failed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            body <span class="token operator">=</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;åŠ è½½å¤±è´¥ï¼ç‚¹å‡»é‡è¯•ï¼&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>mode <span class="token operator">==</span> <span class="token class-name">LoadStatus</span><span class="token punctuation">.</span>canLoading<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            body <span class="token operator">=</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;æ¾æ‰‹,åŠ è½½æ›´å¤š!&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            body <span class="token operator">=</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;æ²¡æœ‰æ›´å¤šæ•°æ®äº†!&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">return</span> <span class="token class-name">Container</span><span class="token punctuation">(</span>
            height<span class="token punctuation">:</span> <span class="token number">55.0</span><span class="token punctuation">,</span>
            child<span class="token punctuation">:</span> <span class="token class-name">Center</span><span class="token punctuation">(</span>child<span class="token punctuation">:</span> body<span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
      controller<span class="token punctuation">:</span> _refreshController<span class="token punctuation">,</span>
      onRefresh<span class="token punctuation">:</span> _onRefresh<span class="token punctuation">,</span>
      onLoading<span class="token punctuation">:</span> _onLoading<span class="token punctuation">,</span>
      child<span class="token punctuation">:</span> <span class="token class-name">ListView</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span>
        itemBuilder<span class="token punctuation">:</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span>
            <span class="token class-name">Card</span><span class="token punctuation">(</span>child<span class="token punctuation">:</span> <span class="token class-name">Center</span><span class="token punctuation">(</span>child<span class="token punctuation">:</span> <span class="token class-name">Text</span><span class="token punctuation">(</span>_lists<span class="token operator">!</span><span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        itemExtent<span class="token punctuation">:</span> <span class="token number">100.0</span><span class="token punctuation">,</span>
        itemCount<span class="token punctuation">:</span> _lists<span class="token operator">?</span><span class="token punctuation">.</span>length <span class="token operator">?</span><span class="token operator">?</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>éœ€è¦æ³¨æ„ï¼Œsqfliteå¦‚æœæ˜¯ä¸€ç›´æ’å…¥æ•°æ®ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°æ®é‡å¤ï¼Œå¦‚ä½•é¿å…ï¼Ÿ</p> <p>è°ƒæ•´<code>content_provider.dart</code>ï¼š</p> <div class="language-dart extra-class"><pre class="language-dart"><code>  <span class="token function">addPostBatch</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Post</span><span class="token punctuation">&gt;</span></span> lists<span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">final</span> db <span class="token operator">=</span> <span class="token keyword">await</span> database<span class="token punctuation">;</span>
      <span class="token class-name">Batch</span> batch <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">batch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      lists<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        batch<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>
          <span class="token string-literal"><span class="token string">'posts'</span></span><span class="token punctuation">,</span>
          element<span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token comment">// å¦‚æœä¸»é”®å†²çªï¼Œç›´æ¥å¿½ç•¥å³å¯</span>
          conflictAlgorithm<span class="token punctuation">:</span> <span class="token class-name">ConflictAlgorithm</span><span class="token punctuation">.</span>ignore<span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> res <span class="token operator">=</span> <span class="token keyword">await</span> batch<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> res<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'err is ğŸ‘‰ </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">err</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre></div><h3 id="é•¿åˆ—è¡¨å¼‚æ­¥æ•°æ®æ–¹æ¡ˆ"><a href="#é•¿åˆ—è¡¨å¼‚æ­¥æ•°æ®æ–¹æ¡ˆ" class="header-anchor">#</a> é•¿åˆ—è¡¨å¼‚æ­¥æ•°æ®æ–¹æ¡ˆ</h3> <p>ä¸Šé¢çš„ç« èŠ‚ï¼Œä»‹ç»äº†ä¸‹æ‹‰åˆ·æ–°ä¸ä¸Šæ‹‰åŠ è½½ï¼Œä½†æ˜¯å¯¹äºå¼‚æ­¥å¤§é‡çš„æ•°æ®ï¼Œä½¿ç”¨æ•°ç»„çš„æ–¹æ¡ˆï¼Œæ•ˆç‡ä½ä¸‹ï¼Œè€Œä¸”å¯èƒ½ä¼šå¸¦æ¥æ€§èƒ½é—®é¢˜ã€‚å¦‚æœæ˜¯é•¿åˆ—è¡¨å¼‚æ­¥æ•°æ®ï¼Œå°±éœ€è¦å€ŸåŠ©åŸç”Ÿç»„ä»¶ <code>StreamBuilder</code>å’Œ<code>FutureBuilder</code> äº†ã€‚</p> <p>é¦–å…ˆï¼Œéœ€è¦è°ƒæ•´æ¥å£æœåŠ¡ï¼Œè¿”å›ç‰¹å®šçš„<code>Post</code>æ€§èƒ½æ•°æ®ï¼š</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token keyword">class</span> <span class="token class-name">ContentService</span> <span class="token punctuation">{</span>
  <span class="token comment">// è·å–æ–‡ç« åˆ—è¡¨</span>
  <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Post</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">getPostList</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token class-name">ListQuery</span><span class="token operator">?</span> query<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token keyword">dynamic</span><span class="token punctuation">&gt;</span></span> params <span class="token operator">=</span> query<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">toJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token class-name">Response</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token class-name">DioHttp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'/public/list'</span></span><span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>statusCode <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">HttpResponse</span> httpResponse <span class="token operator">=</span> <span class="token class-name">HttpResponse</span><span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>httpResponse<span class="token punctuation">.</span>code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Post</span><span class="token punctuation">&gt;</span></span> lists <span class="token operator">=</span>
            httpResponse<span class="token punctuation">.</span>data<span class="token punctuation">.</span>map<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Post</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token class-name">Post</span><span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// print('lists is ğŸ‘‰ $lists');</span>
        <span class="token keyword">await</span> <span class="token class-name">ContentProvider</span><span class="token punctuation">.</span>db<span class="token punctuation">.</span><span class="token function">addPostBatch</span><span class="token punctuation">(</span>lists<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> lists<span class="token punctuation">;</span>
        <span class="token comment">// var res2 = await ContentProvider.db.getPost('5fde262d7f2fcb6844ada5a9');</span>
        <span class="token comment">// print('res is ğŸ‘‰ $res1');</span>
        <span class="token comment">// print('res is ğŸ‘‰ $res2');</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Post</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åœ¨<code>home_page.dart</code>ä¸­ä½¿ç”¨ï¼š</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token metadata function">@override</span>
<span class="token class-name">Widget</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token class-name">FutureBuilder</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Post</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>
    future<span class="token punctuation">:</span> <span class="token function">_getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// FutureBuilder -&gt; future -&gt; æ‰§è¡Œä¸€æ¬¡</span>
    <span class="token comment">// StreamBuilder -&gt; stream -&gt; æ‰§è¡Œå¤šæ¬¡ -&gt; streamControler.sink.add</span>
    builder<span class="token punctuation">:</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span> snapshot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>snapshot<span class="token punctuation">.</span>hasData<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token class-name">SmartRefresher</span><span class="token punctuation">(</span>
        enablePullDown<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        enablePullUp<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        header<span class="token punctuation">:</span> <span class="token class-name">WaterDropHeader</span><span class="token punctuation">(</span>
          complete<span class="token punctuation">:</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          completeDuration<span class="token punctuation">:</span> <span class="token class-name">Duration</span><span class="token punctuation">.</span>zero<span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        footer<span class="token punctuation">:</span> <span class="token class-name">CustomFooter</span><span class="token punctuation">(</span>
          builder<span class="token punctuation">:</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span> mode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>mode <span class="token operator">==</span> <span class="token class-name">LoadStatus</span><span class="token punctuation">.</span>idle<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              body <span class="token operator">=</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;ä¸Šæ‹‰åŠ è½½&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>mode <span class="token operator">==</span> <span class="token class-name">LoadStatus</span><span class="token punctuation">.</span>loading<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              body <span class="token operator">=</span> <span class="token class-name">CupertinoActivityIndicator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>mode <span class="token operator">==</span> <span class="token class-name">LoadStatus</span><span class="token punctuation">.</span>failed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              body <span class="token operator">=</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;åŠ è½½å¤±è´¥ï¼ç‚¹å‡»é‡è¯•ï¼&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>mode <span class="token operator">==</span> <span class="token class-name">LoadStatus</span><span class="token punctuation">.</span>canLoading<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              body <span class="token operator">=</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;æ¾æ‰‹,åŠ è½½æ›´å¤š!&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
              body <span class="token operator">=</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;æ²¡æœ‰æ›´å¤šæ•°æ®äº†!&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token class-name">Container</span><span class="token punctuation">(</span>
              height<span class="token punctuation">:</span> <span class="token number">55.0</span><span class="token punctuation">,</span>
              child<span class="token punctuation">:</span> <span class="token class-name">Center</span><span class="token punctuation">(</span>child<span class="token punctuation">:</span> body<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        controller<span class="token punctuation">:</span> _refreshController<span class="token punctuation">,</span>
        onRefresh<span class="token punctuation">:</span> _onRefresh<span class="token punctuation">,</span>
        onLoading<span class="token punctuation">:</span> _onLoading<span class="token punctuation">,</span>
        child<span class="token punctuation">:</span> <span class="token class-name">ListView</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span>
          itemBuilder<span class="token punctuation">:</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span>
          <span class="token class-name">Card</span><span class="token punctuation">(</span>child<span class="token punctuation">:</span> <span class="token class-name">Center</span><span class="token punctuation">(</span>child<span class="token punctuation">:</span> <span class="token class-name">Text</span><span class="token punctuation">(</span>_lists<span class="token operator">!</span><span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          itemExtent<span class="token punctuation">:</span> <span class="token number">100.0</span><span class="token punctuation">,</span>
          itemCount<span class="token punctuation">:</span> _lists<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token class-name">CupertinoActivityIndicator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™é‡Œçš„<code>_getData()</code>å¦‚ä¸‹ï¼š</p> <div class="language-dart extra-class"><pre class="language-dart"><code><span class="token class-name">ContentService</span> contentService <span class="token operator">=</span> getIt<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ContentService</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// å®šä¹‰é¡µé¢æ•°æ®</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Post</span><span class="token punctuation">&gt;</span></span> _lists <span class="token operator">=</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Post</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Post</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">_getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
  _lists <span class="token operator">=</span> <span class="token keyword">await</span> contentService<span class="token punctuation">.</span><span class="token function">getPostList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> _lists<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <!----> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/notes-page/project/community-flutter/17-è·¯ç”±.html" class="prev">
        è·¯ç”±
      </a></span> <span class="next"><a href="/notes-page/project/community-flutter/19-è‹¹æœå¼€å‘è€….html">
        è‹¹æœå¼€å‘è€…
      </a>
      â†’
    </span></p></div>  <div class="el-dialog__wrapper" style="display:none;"><div role="dialog" aria-modal="true" aria-label="dialog" class="el-dialog" style="margin-top:15vh;width:420px;"><div class="el-dialog__header"><span class="el-dialog__title"></span><button type="button" aria-label="Close" class="el-dialog__headerbtn"><i class="el-dialog__close el-icon el-icon-close"></i></button></div><!----><div class="el-dialog__footer"><span class="dialog-footer"><button type="button" class="el-button el-button--default"><!----><!----><span>å– æ¶ˆ</span></button> <button type="button" class="el-button el-button--primary"><!----><!----><span>ç¡® å®š</span></button></span></div></div></div></main> <!----></div><div class="global-ui"><!----><div tabindex="-1" role="dialog" aria-hidden="true" class="pswp"><div class="pswp__bg"></div> <div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div> <div class="pswp__item"></div> <div class="pswp__item"></div></div> <div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div> <button title="Close" aria-label="Close" class="pswp__button pswp__button--close"></button> <button title="Share" aria-label="Share" class="pswp__button pswp__button--share"></button> <button title="Switch to full screen" aria-label="Switch to full screen" class="pswp__button pswp__button--fs"></button> <button title="Zoom in/out" aria-label="Zoom in/out" class="pswp__button pswp__button--zoom"></button> <div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div> <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div> <button title="Prev (Arrow Left)" aria-label="Prev (Arrow Left)" class="pswp__button pswp__button--arrow--left"></button> <button title="Next (Arrow Right)" aria-label="Next (Arrow Right)" class="pswp__button pswp__button--arrow--right"></button> <div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div></div></div>
    <script src="/notes-page/assets/js/app.13c7e4b8.js" defer></script><script src="/notes-page/assets/js/5.d4cdcacd.js" defer></script><script src="/notes-page/assets/js/45.93743a6b.js" defer></script>
  </body>
</html>
