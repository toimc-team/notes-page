<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack5构建加持 | 大前端 - 前端高级进阶</title>
    <meta name="generator" content="VuePress 1.9.5">
    
    <meta name="description" content="大前端课程电子书">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/notes-page/assets/css/0.styles.f7abcd47.css" as="style"><link rel="preload" href="/notes-page/assets/js/app.57fa022d.js" as="script"><link rel="preload" href="/notes-page/assets/js/8.4c2d1a00.js" as="script"><link rel="preload" href="/notes-page/assets/js/13.72e91839.js" as="script"><link rel="prefetch" href="/notes-page/assets/js/1.f63f2f86.js"><link rel="prefetch" href="/notes-page/assets/js/10.cee2a91b.js"><link rel="prefetch" href="/notes-page/assets/js/100.f3cf604f.js"><link rel="prefetch" href="/notes-page/assets/js/101.a861db94.js"><link rel="prefetch" href="/notes-page/assets/js/102.3e478671.js"><link rel="prefetch" href="/notes-page/assets/js/103.a257b7be.js"><link rel="prefetch" href="/notes-page/assets/js/104.da89f194.js"><link rel="prefetch" href="/notes-page/assets/js/105.889ed990.js"><link rel="prefetch" href="/notes-page/assets/js/106.0c5ad02a.js"><link rel="prefetch" href="/notes-page/assets/js/107.0d9ba6ed.js"><link rel="prefetch" href="/notes-page/assets/js/108.d331ee98.js"><link rel="prefetch" href="/notes-page/assets/js/109.14399446.js"><link rel="prefetch" href="/notes-page/assets/js/11.06b35af2.js"><link rel="prefetch" href="/notes-page/assets/js/110.e9844bb3.js"><link rel="prefetch" href="/notes-page/assets/js/111.67a494e8.js"><link rel="prefetch" href="/notes-page/assets/js/112.4a2fea5d.js"><link rel="prefetch" href="/notes-page/assets/js/113.a28d295a.js"><link rel="prefetch" href="/notes-page/assets/js/114.708f8afb.js"><link rel="prefetch" href="/notes-page/assets/js/115.a2769f6f.js"><link rel="prefetch" href="/notes-page/assets/js/116.520028ab.js"><link rel="prefetch" href="/notes-page/assets/js/117.4a095536.js"><link rel="prefetch" href="/notes-page/assets/js/118.f633410c.js"><link rel="prefetch" href="/notes-page/assets/js/119.925e42e1.js"><link rel="prefetch" href="/notes-page/assets/js/12.2eadb290.js"><link rel="prefetch" href="/notes-page/assets/js/120.349d7a75.js"><link rel="prefetch" href="/notes-page/assets/js/121.877ebd14.js"><link rel="prefetch" href="/notes-page/assets/js/122.405f425d.js"><link rel="prefetch" href="/notes-page/assets/js/123.1af37d09.js"><link rel="prefetch" href="/notes-page/assets/js/124.f58a746d.js"><link rel="prefetch" href="/notes-page/assets/js/125.f7e4a024.js"><link rel="prefetch" href="/notes-page/assets/js/126.0f31549e.js"><link rel="prefetch" href="/notes-page/assets/js/127.ff19b6d0.js"><link rel="prefetch" href="/notes-page/assets/js/128.238b7645.js"><link rel="prefetch" href="/notes-page/assets/js/129.7fcb4718.js"><link rel="prefetch" href="/notes-page/assets/js/130.7bfba10f.js"><link rel="prefetch" href="/notes-page/assets/js/131.486e0ddb.js"><link rel="prefetch" href="/notes-page/assets/js/132.e3183cb3.js"><link rel="prefetch" href="/notes-page/assets/js/133.12cb25be.js"><link rel="prefetch" href="/notes-page/assets/js/134.acc7c215.js"><link rel="prefetch" href="/notes-page/assets/js/135.88199a53.js"><link rel="prefetch" href="/notes-page/assets/js/136.3c19cc5a.js"><link rel="prefetch" href="/notes-page/assets/js/137.dd857618.js"><link rel="prefetch" href="/notes-page/assets/js/138.c933fc20.js"><link rel="prefetch" href="/notes-page/assets/js/139.de066133.js"><link rel="prefetch" href="/notes-page/assets/js/14.39a7ab1c.js"><link rel="prefetch" href="/notes-page/assets/js/140.ce794313.js"><link rel="prefetch" href="/notes-page/assets/js/141.c8abc7e7.js"><link rel="prefetch" href="/notes-page/assets/js/142.c456b20f.js"><link rel="prefetch" href="/notes-page/assets/js/143.c7f15a08.js"><link rel="prefetch" href="/notes-page/assets/js/144.5d1b7823.js"><link rel="prefetch" href="/notes-page/assets/js/145.b0e46881.js"><link rel="prefetch" href="/notes-page/assets/js/146.61c56e8a.js"><link rel="prefetch" href="/notes-page/assets/js/147.4e1329e5.js"><link rel="prefetch" href="/notes-page/assets/js/148.226b4c3d.js"><link rel="prefetch" href="/notes-page/assets/js/149.fe5cadbc.js"><link rel="prefetch" href="/notes-page/assets/js/15.c73b0b6d.js"><link rel="prefetch" href="/notes-page/assets/js/150.eaf9e989.js"><link rel="prefetch" href="/notes-page/assets/js/151.bfdf707f.js"><link rel="prefetch" href="/notes-page/assets/js/152.679cb300.js"><link rel="prefetch" href="/notes-page/assets/js/153.6b678318.js"><link rel="prefetch" href="/notes-page/assets/js/154.d185dbdf.js"><link rel="prefetch" href="/notes-page/assets/js/155.49202295.js"><link rel="prefetch" href="/notes-page/assets/js/16.cf610772.js"><link rel="prefetch" href="/notes-page/assets/js/17.5d5e4843.js"><link rel="prefetch" href="/notes-page/assets/js/18.a0a9529b.js"><link rel="prefetch" href="/notes-page/assets/js/19.90f902cc.js"><link rel="prefetch" href="/notes-page/assets/js/20.f37c1c22.js"><link rel="prefetch" href="/notes-page/assets/js/21.c05dedf4.js"><link rel="prefetch" href="/notes-page/assets/js/22.a8240d79.js"><link rel="prefetch" href="/notes-page/assets/js/23.19547502.js"><link rel="prefetch" href="/notes-page/assets/js/24.9d056690.js"><link rel="prefetch" href="/notes-page/assets/js/25.c804cfc8.js"><link rel="prefetch" href="/notes-page/assets/js/26.08e28f25.js"><link rel="prefetch" href="/notes-page/assets/js/27.1d4feda0.js"><link rel="prefetch" href="/notes-page/assets/js/28.14a24a36.js"><link rel="prefetch" href="/notes-page/assets/js/29.ddf73d1e.js"><link rel="prefetch" href="/notes-page/assets/js/30.5687e94a.js"><link rel="prefetch" href="/notes-page/assets/js/31.15264093.js"><link rel="prefetch" href="/notes-page/assets/js/32.05f9a4df.js"><link rel="prefetch" href="/notes-page/assets/js/33.17d267be.js"><link rel="prefetch" href="/notes-page/assets/js/34.5f5d29ef.js"><link rel="prefetch" href="/notes-page/assets/js/35.de0a5e08.js"><link rel="prefetch" href="/notes-page/assets/js/36.daae5c58.js"><link rel="prefetch" href="/notes-page/assets/js/37.a1fd543e.js"><link rel="prefetch" href="/notes-page/assets/js/38.cfcae207.js"><link rel="prefetch" href="/notes-page/assets/js/39.a29fe807.js"><link rel="prefetch" href="/notes-page/assets/js/40.99fbf5bb.js"><link rel="prefetch" href="/notes-page/assets/js/41.0278a2ef.js"><link rel="prefetch" href="/notes-page/assets/js/42.6eb36571.js"><link rel="prefetch" href="/notes-page/assets/js/43.51911082.js"><link rel="prefetch" href="/notes-page/assets/js/44.6b378c67.js"><link rel="prefetch" href="/notes-page/assets/js/45.00b02e26.js"><link rel="prefetch" href="/notes-page/assets/js/46.24aac327.js"><link rel="prefetch" href="/notes-page/assets/js/47.510165a4.js"><link rel="prefetch" href="/notes-page/assets/js/48.d378cc6b.js"><link rel="prefetch" href="/notes-page/assets/js/49.62d93e1a.js"><link rel="prefetch" href="/notes-page/assets/js/50.ce251ab5.js"><link rel="prefetch" href="/notes-page/assets/js/51.b7ba7ea6.js"><link rel="prefetch" href="/notes-page/assets/js/52.342338b0.js"><link rel="prefetch" href="/notes-page/assets/js/53.1f88845f.js"><link rel="prefetch" href="/notes-page/assets/js/54.71bd5f19.js"><link rel="prefetch" href="/notes-page/assets/js/55.c36617ed.js"><link rel="prefetch" href="/notes-page/assets/js/56.0df0dddc.js"><link rel="prefetch" href="/notes-page/assets/js/57.41222b92.js"><link rel="prefetch" href="/notes-page/assets/js/58.6c0d18bc.js"><link rel="prefetch" href="/notes-page/assets/js/59.c1cfd641.js"><link rel="prefetch" href="/notes-page/assets/js/6.6c18ba15.js"><link rel="prefetch" href="/notes-page/assets/js/60.0b74105f.js"><link rel="prefetch" href="/notes-page/assets/js/61.c97be195.js"><link rel="prefetch" href="/notes-page/assets/js/62.9da7f6fc.js"><link rel="prefetch" href="/notes-page/assets/js/63.f2522bf5.js"><link rel="prefetch" href="/notes-page/assets/js/64.9875add3.js"><link rel="prefetch" href="/notes-page/assets/js/65.dd431282.js"><link rel="prefetch" href="/notes-page/assets/js/66.c81c845a.js"><link rel="prefetch" href="/notes-page/assets/js/67.942a561e.js"><link rel="prefetch" href="/notes-page/assets/js/68.3a1e9aca.js"><link rel="prefetch" href="/notes-page/assets/js/69.017fd889.js"><link rel="prefetch" href="/notes-page/assets/js/7.d3dd090a.js"><link rel="prefetch" href="/notes-page/assets/js/70.d7e13888.js"><link rel="prefetch" href="/notes-page/assets/js/71.994e482e.js"><link rel="prefetch" href="/notes-page/assets/js/72.4203b9e8.js"><link rel="prefetch" href="/notes-page/assets/js/73.eba78313.js"><link rel="prefetch" href="/notes-page/assets/js/74.ea691d5a.js"><link rel="prefetch" href="/notes-page/assets/js/75.a80421fc.js"><link rel="prefetch" href="/notes-page/assets/js/76.4514ad34.js"><link rel="prefetch" href="/notes-page/assets/js/77.edc2b3e1.js"><link rel="prefetch" href="/notes-page/assets/js/78.b6bde151.js"><link rel="prefetch" href="/notes-page/assets/js/79.e9e726bc.js"><link rel="prefetch" href="/notes-page/assets/js/80.6521a021.js"><link rel="prefetch" href="/notes-page/assets/js/81.137bdea4.js"><link rel="prefetch" href="/notes-page/assets/js/82.14e28497.js"><link rel="prefetch" href="/notes-page/assets/js/83.6ead6db7.js"><link rel="prefetch" href="/notes-page/assets/js/84.ed3ae77c.js"><link rel="prefetch" href="/notes-page/assets/js/85.1d088f48.js"><link rel="prefetch" href="/notes-page/assets/js/86.9634221b.js"><link rel="prefetch" href="/notes-page/assets/js/87.d4534b16.js"><link rel="prefetch" href="/notes-page/assets/js/88.954c749d.js"><link rel="prefetch" href="/notes-page/assets/js/89.1c4cc9a4.js"><link rel="prefetch" href="/notes-page/assets/js/9.90861c2c.js"><link rel="prefetch" href="/notes-page/assets/js/90.eaef8677.js"><link rel="prefetch" href="/notes-page/assets/js/91.ad34da48.js"><link rel="prefetch" href="/notes-page/assets/js/92.1fdf1439.js"><link rel="prefetch" href="/notes-page/assets/js/93.250ed534.js"><link rel="prefetch" href="/notes-page/assets/js/94.643e7687.js"><link rel="prefetch" href="/notes-page/assets/js/95.d4d10740.js"><link rel="prefetch" href="/notes-page/assets/js/96.3eb75ab9.js"><link rel="prefetch" href="/notes-page/assets/js/97.8c936afa.js"><link rel="prefetch" href="/notes-page/assets/js/98.6c143074.js"><link rel="prefetch" href="/notes-page/assets/js/99.e62e9833.js"><link rel="prefetch" href="/notes-page/assets/js/vendors~docsearch.c4e92a92.js"><link rel="prefetch" href="/notes-page/assets/js/vendors~photo-swipe.b8260d4e.js"><link rel="prefetch" href="/notes-page/assets/js/vendors~search-page.d41e229f.js">
    <link rel="stylesheet" href="/notes-page/assets/css/0.styles.f7abcd47.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/notes-page/" class="home-link router-link-active"><!----> <span class="site-name">大前端 - 前端高级进阶</span></a> <div class="links"><div id="docsearch"></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>开发环境</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes-page/basic/debug/" class="sidebar-link">整体介绍</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Node.js进阶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes-page/basic/node/" aria-current="page" class="sidebar-link">内容介绍</a></li><li><a href="/notes-page/basic/node/01-koa.html" class="sidebar-link">Koa(下一代web框架)</a></li><li><a href="/notes-page/basic/node/02-webpack5构建.html" class="active sidebar-link">webpack5构建加持</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes-page/basic/node/02-webpack5构建.html#项目目标" class="sidebar-link">项目目标</a></li><li class="sidebar-sub-header"><a href="/notes-page/basic/node/02-webpack5构建.html#项目目录结构" class="sidebar-link">项目目录结构</a></li><li class="sidebar-sub-header"><a href="/notes-page/basic/node/02-webpack5构建.html#搭建项目" class="sidebar-link">搭建项目</a></li><li class="sidebar-sub-header"><a href="/notes-page/basic/node/02-webpack5构建.html#配置-webpack" class="sidebar-link">配置 webpack</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes-page/basic/node/02-webpack5构建.html#测试构建" class="sidebar-link">测试构建</a></li><li class="sidebar-sub-header"><a href="/notes-page/basic/node/02-webpack5构建.html#优化构建配置" class="sidebar-link">优化构建配置</a></li></ul></li><li class="sidebar-sub-header"><a href="/notes-page/basic/node/02-webpack5构建.html#路由自动注册" class="sidebar-link">路由自动注册</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes-page/basic/node/02-webpack5构建.html#使用require-directory" class="sidebar-link">使用require-directory</a></li><li class="sidebar-sub-header"><a href="/notes-page/basic/node/02-webpack5构建.html#使用require-context-webpack-功能" class="sidebar-link">使用require.context（webpack）功能</a></li></ul></li><li class="sidebar-sub-header"><a href="/notes-page/basic/node/02-webpack5构建.html#配置别名" class="sidebar-link">配置别名</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes-page/basic/node/02-webpack5构建.html#使用webpack的别名功能" class="sidebar-link">使用webpack的别名功能</a></li><li class="sidebar-sub-header"><a href="/notes-page/basic/node/02-webpack5构建.html#使用module-alias" class="sidebar-link">使用module-alias</a></li></ul></li></ul></li><li><a href="/notes-page/basic/node/03-项目规范及工具.html" class="sidebar-link">项目规范及工具</a></li><li><a href="/notes-page/basic/node/04-正则表达式入门.html" class="sidebar-link">正则表达式入门</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>TypeScript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes-page/basic/ts/" class="sidebar-link">导学</a></li><li><a href="/notes-page/basic/ts/01-学习方法.html" class="sidebar-link">学习方法</a></li><li><a href="/notes-page/basic/ts/02-环境配置.html" class="sidebar-link">环境配置</a></li><li><a href="/notes-page/basic/ts/03-基础类型.html" class="sidebar-link">基础类型</a></li><li><a href="/notes-page/basic/ts/03.1-函数类型.html" class="sidebar-link">函数类型</a></li><li><a href="/notes-page/basic/ts/04-新引入类型.html" class="sidebar-link">TS引入的新类型</a></li><li><a href="/notes-page/basic/ts/05-交叉类型与联合类型.html" class="sidebar-link">交叉类型与联合类型</a></li><li><a href="/notes-page/basic/ts/06-TS工作原理及概念.html" class="sidebar-link">工作原理相关概念</a></li><li><a href="/notes-page/basic/ts/07-接口Interface.html" class="sidebar-link">Interface 接口</a></li><li><a href="/notes-page/basic/ts/08-类.html" class="sidebar-link">Class 类</a></li><li><a href="/notes-page/basic/ts/09-泛型.html" class="sidebar-link">Generics 泛型</a></li><li><a href="/notes-page/basic/ts/10-类型别名与字面量.html" class="sidebar-link">类型别名type与字面量类型</a></li><li><a href="/notes-page/basic/ts/11-装饰器.html" class="sidebar-link">装饰器</a></li><li><a href="/notes-page/basic/ts/12-模块&amp;命名空间.html" class="sidebar-link">模块&amp;命名空间</a></li><li><a href="/notes-page/basic/ts/13-声明相关.html" class="sidebar-link">声明相关</a></li><li><a href="/notes-page/basic/ts/14-tsconfig.json配置文件.html" class="sidebar-link">tsconfig.json文件</a></li><li><a href="/notes-page/basic/ts/15-扩展阅读.html" class="sidebar-link">扩展阅读</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Dart</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes-page/basic/dart/" class="sidebar-link">Dart介绍</a></li><li><a href="/notes-page/basic/dart/01-类型基础：变量与常量.html" class="sidebar-link">变量与常量</a></li><li><a href="/notes-page/basic/dart/02-类型基础.html" class="sidebar-link">数据类型</a></li><li><a href="/notes-page/basic/dart/03-操作符.html" class="sidebar-link">运算符</a></li><li><a href="/notes-page/basic/dart/04-流程控制.html" class="sidebar-link">流程控制和错误处理</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>mongoDB</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes-page/basic/mongo/" class="sidebar-link">认识 MongoDB</a></li><li><a href="/notes-page/basic/mongo/01-创建用户并分配权限.html" class="sidebar-link">创建用户并分配权限</a></li><li><a href="/notes-page/basic/mongo/01.1连接MongoDB.html" class="sidebar-link">MongoDB交互终端</a></li><li><a href="/notes-page/basic/mongo/02-基础操作.html" class="sidebar-link">基本操作</a></li><li><a href="/notes-page/basic/mongo/03-高级查询.html" class="sidebar-link">高级查询</a></li><li><a href="/notes-page/basic/mongo/04-复制集.html" class="sidebar-link">复制集</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>前端安全</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes-page/basic/security/" class="sidebar-link">概述</a></li><li><a href="/notes-page/basic/security/01-XSS.html" class="sidebar-link">XSS</a></li><li><a href="/notes-page/basic/security/02-CSRF.html" class="sidebar-link">CSRF</a></li><li><a href="/notes-page/basic/security/03-点击劫持.html" class="sidebar-link">点击劫持</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>程序员英语</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes-page/basic/english/" class="sidebar-link">程序员英语手册</a></li><li><a href="/notes-page/basic/english/01-基础词汇.html" class="sidebar-link">基础词汇</a></li><li><a href="/notes-page/basic/english/02-进阶词汇.html" class="sidebar-link">进阶词汇</a></li><li><a href="/notes-page/basic/english/03-算法常用词汇.html" class="sidebar-link">算法常用词汇</a></li><li><a href="/notes-page/basic/english/04-会议常用词汇.html" class="sidebar-link">会议常用词汇</a></li><li><a href="/notes-page/basic/english/05-软件开发相关词汇.html" class="sidebar-link">软件开发相关词汇</a></li><li><a href="/notes-page/basic/english/06-其他词汇.html" class="sidebar-link">其他词汇</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="webpack5构建加持"><a href="#webpack5构建加持" class="header-anchor">#</a> webpack5构建加持</h1> <p>更多webpack相关的内容，可以翻看<a href="/notes-page/devops/webpack/">webpack的专栏</a>。</p> <h2 id="项目目标"><a href="#项目目标" class="header-anchor">#</a> 项目目标</h2> <ul><li>支持 es6+语法</li> <li>开发热更新</li> <li>webpack5 构建</li> <li>接口搭建</li> <li>路由合并，路由自动注册</li> <li>添加项目规范</li> <li>配置自定义别名</li></ul> <h2 id="项目目录结构"><a href="#项目目录结构" class="header-anchor">#</a> 项目目录结构</h2> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">service</span>
├─ .husky
│   ├─ _
│   │   └─ husky.sh
│   ├─ .gitignore
│   ├─ pre-commit
├─ config
│   ├─ webpack.config.base.js
│   ├─ webpack.config.dev.js
│   └─ webpack.config.prod.js
├─ src
│   ├─ api
│   │  └─ v1
│   │     ├─ demo.js
│   │     └─ test.js
│   ├─ config
│   ├─ controller
│   │  └─ v1
│   │     ├─ demo.js
│   │     └─ test.js
│   ├─ model
│   ├─ routes
│   │   └─ index.js
│   └─ app.js
├─ package-lock.json
├─ package.json
├─ .prettierrc
├─ .babelrc
├─ .editorconfig
├─ .eslintrc.js
└─ .gitignore

</code></pre></div><h2 id="搭建项目"><a href="#搭建项目" class="header-anchor">#</a> 搭建项目</h2> <div class="language-shell extra-class"><pre class="language-shell"><code>// 创建项目目录
$ <span class="token function">mkdir</span> <span class="token function">service</span>

// 进入service文件夹
$ <span class="token builtin class-name">cd</span> <span class="token function">service</span>

// 初始化package.json
$ <span class="token function">npm</span> init -y

// 创建源码目录
<span class="token function">mkdir</span> src
</code></pre></div><ol><li><strong>安装<code>koa</code>、<code>@koa/router</code> （如果已经配置可路过）</strong></li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">yarn</span> <span class="token function">add</span> koa @koa/router
</code></pre></div><ol start="2"><li><strong>创建入口文件</strong></li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">touch</span> src/app.js
</code></pre></div><ol start="3"><li><strong>安装构建依赖</strong></li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">yarn</span> <span class="token function">add</span> -D webpack webpack-cli @babel/node @babel/core @babel/preset-env babel-loader clean-webpack-plugin nodemon webpack-node-externals webpack-merge rimraf
</code></pre></div><ol start="4"><li><strong>在项目根目录添加<code>.babelrc</code>文件</strong></li></ol> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;targets&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;node&quot;</span><span class="token operator">:</span> <span class="token string">&quot;current&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="5"><li><strong>添加测试接口</strong></li></ol> <blockquote><p>在<code>app.js</code>中添加测试接口，由于已经配置了<code>babel</code>解析，所以可以直接在<code>app.js</code>中写 es6+语法</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> Koa <span class="token keyword">from</span> <span class="token string">'koa'</span>
<span class="token keyword">import</span> Router <span class="token keyword">from</span> <span class="token string">'@koa/router'</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'success'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">nickname</span><span class="token operator">:</span> <span class="token string">'Forest'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'前端工程师'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">'webpack5构建node应用'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> port <span class="token operator">=</span> <span class="token number">3002</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">服务启动在</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">端口</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><ol start="6"><li><strong>启动服务</strong></li></ol> <div class="language-shell extra-class"><pre class="language-shell"><code>$ npx babel-node src/app.js
</code></pre></div><ol start="7"><li><strong>在 postman 中请求接口</strong></li></ol> <p><img src="/notes-page/assets/img/image-20210504072925109.5a1b059f.png" alt="image-20210504072925109"></p> <h2 id="配置-webpack"><a href="#配置-webpack" class="header-anchor">#</a> 配置 webpack</h2> <p><a href="https://webpack.js.org/concepts/" target="_blank" rel="noopener noreferrer">英文文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://webpack.docschina.org/concepts/" target="_blank" rel="noopener noreferrer">中文文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="custom-block tip"><p class="custom-block-title">核心概念</p> <ul><li><p><strong>entry</strong>：入口；指示 <code>webpack</code> 应该使用哪个模块，默认值是 <code>./src/index.js</code></p></li> <li><p><strong>output</strong>：输出；<code>output</code> 属性告诉 <code>webpack</code> 在哪里输出它所创建的 <em>bundle</em>，默认值是 <code>./dist/main.js</code></p></li> <li><p><strong>loader</strong>：loader 负责完成项目中各种各样资源模块的加载</p></li> <li><p><strong>plugins</strong>：插件；用来解决项目中除了资源模块打包以外的其他自动化工作。包括：打包优化，资源管理，注入环境变量</p></li> <li><p><strong>mode</strong>：模式；通过选择 <code>development</code>, <code>production</code> 或 <code>none</code> 之中的一个，来设置 <code>mode</code> 参数，你可以启用 webpack 内置在相应环境下的优化。其默认值为 <code>production</code>。</p></li></ul></div> <blockquote><p>在项目根目录创建<code>webpack.config.js</code>文件</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> DefinePlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> nodeExternals <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-node-externals'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> CleanWebpackPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'clean-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 打包编译为某一端侧的可使用代码  默认值：web  https://webpack.docschina.org/configuration/target/</span>
  <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">'node'</span><span class="token punctuation">,</span>

  <span class="token comment">// 打包模式，可选择值：development、production</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'development'</span><span class="token punctuation">,</span>

  <span class="token comment">// 控制是否生成，以及如何生成 source map。 https://webpack.docschina.org/configuration/devtool/#root</span>
  <span class="token literal-property property">devtool</span><span class="token operator">:</span> <span class="token string">'eval-cheap-source-map'</span><span class="token punctuation">,</span>

  <span class="token comment">// 打包模块入口文件</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">server</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/src/app.js</span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 打包后的输入文件</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">'[name].bundle.js'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/dist</span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 匹配解析规则</span>
  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(js|jsx)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">'babel-loader'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/node_modules</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 构建过程中使用的插件</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token string-property property">'process.env'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token constant">NODE_ENV</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>
          process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span> <span class="token operator">||</span>
            process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'prod'</span>
            <span class="token operator">?</span> <span class="token string">'production'</span>
            <span class="token operator">:</span> <span class="token string">'development'</span>
        <span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>

  <span class="token comment">// 防止第三方依赖被打包</span>
  <span class="token literal-property property">externals</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">nodeExternals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="测试构建"><a href="#测试构建" class="header-anchor">#</a> 测试构建</h3> <div class="language-shell extra-class"><pre class="language-shell"><code>$ npx webpack
</code></pre></div><p><img src="/notes-page/assets/img/image-20210504083042708.512973a2.png" alt="image-20210504083042708"><img src="data:image/png;base64,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" alt="image-20210504083112577"></p> <blockquote><p>构建成功！</p></blockquote> <div class="custom-block warning"><p class="custom-block-title">思考</p> <p>在实际开发中可能会存在开发环境和生产环境的构建，所以单凭一个配置还不能达到实际的需求，接下来对开发环境和生产环境分别配置。</p></div> <blockquote><p>在项目根目录创建 config 文件，并创建三个文件分别是<code>webpack.config.base.js</code>、<code>webpack.config.dev.js</code>、<code>webpack.config.prod.js</code></p> <ul><li><code>webpack.config.base.js</code> 文件存放开发环境和生产环境都是需要的构建配置</li> <li><code>webpack.config.dev.js</code> 文件存放开发环境的构建配置</li> <li><code>webpack.config.prod.js</code> 存放生产环境的构建配置</li></ul></blockquote> <h3 id="优化构建配置"><a href="#优化构建配置" class="header-anchor">#</a> 优化构建配置</h3> <blockquote><ul><li>mode 独立于构建环境，开发环境为(<code>development</code>)、生产环境为(<code>production</code>)</li> <li>devtool 只有在开发环境下才会存在</li> <li><a href="https://webpack.docschina.org/configuration/stats/" target="_blank" rel="noopener noreferrer">stats<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 属性让你更精确地控制打包后的信息该怎么显示</li></ul></blockquote> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>由于每个开发环境和生产环境都是独立的构建配置，所以要在构建时要合并基础配置；安装<code>webpack-merge</code>合并构建配置</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">npm</span> i -D webpack-merge
</code></pre></div></div> <ul><li>优化 webpack.config.base.js</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// config/webpack.config.base.js</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> DefinePlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> nodeExternals <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-node-externals'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> CleanWebpackPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'clean-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 打包编译为某一端侧的可使用代码  默认值：web  https://webpack.docschina.org/configuration/target/</span>
  <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">'node'</span><span class="token punctuation">,</span>

  <span class="token comment">// 打包模式，可选择值：development、production</span>
  <span class="token comment">// mode: &quot;development&quot;,</span>

  <span class="token comment">// 控制是否生成，以及如何生成 source map。 https://webpack.docschina.org/configuration/devtool/#root</span>
  <span class="token comment">// devtool: &quot;eval-cheap-source-map&quot;,</span>

  <span class="token comment">// 打包模块入口文件</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">server</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/src/app.js</span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 打包后的输入文件</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">'[name].bundle.js'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/dist</span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 匹配解析规则</span>
  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(js|jsx)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">'babel-loader'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/node_modules</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 构建过程中使用的插件</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token string-property property">'process.env'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 设置环境变量 NODE_ENV</span>
        <span class="token constant">NODE_ENV</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>
          process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span> <span class="token operator">||</span>
            process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'prod'</span>
            <span class="token operator">?</span> <span class="token string">'production'</span>
            <span class="token operator">:</span> <span class="token string">'development'</span>
        <span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>

  <span class="token comment">// 防止第三方依赖被打包</span>
  <span class="token literal-property property">externals</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">nodeExternals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>开发环境的构建配置</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// config/webpack.config.dev.js</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> merge <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-merge'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> baseWebpackConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.config.base'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> webpackConfig <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>baseWebpackConfig<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">devtool</span><span class="token operator">:</span> <span class="token string">'eval-cheap-source-map'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'development'</span><span class="token punctuation">,</span>

  <span class="token comment">// 是否添加关于子模块的信息。</span>
  <span class="token literal-property property">stats</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> webpackConfig
</code></pre></div><ul><li>生产环境的构建配置</li></ul> <blockquote><p>生产环境构建时要进行代码压缩，安装<code>terser-webpack-plugin</code>， 命令：<code>npm i -D terser-webpack-plugin</code></p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// config/webpack.config.prod.js</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> merge <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-merge'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> TersetWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'terser-webpack-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> baseWebpackConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.config.base'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> webpackConfig <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>baseWebpackConfig<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">devtool</span><span class="token operator">:</span> <span class="token string">'eval-cheap-source-map'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">stats</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 优化配置</span>
  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 压缩配置</span>
    <span class="token literal-property property">minimize</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">minimizer</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">TersetWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token comment">// 分块策略</span>
    <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 缓存组 https://webpack.docschina.org/plugins/split-chunks-plugin/#splitchunkscachegroups</span>
      <span class="token literal-property property">cacheGroups</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">commens</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'commons'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">'initial'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">minChunks</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
          <span class="token literal-property property">enforce</span><span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> webpackConfig
</code></pre></div><ul><li><p>添加构建脚本命令</p> <blockquote><p>设置环境变量<code>NODE_ENV</code>，由于各环境配置的差异问题，<code>cross-env</code>可以有效的解决跨平台设置环境变量的问题；它是运行跨平台设置和使用环境变量(Node 中的环境变量)的脚本。安装命令：<code>npm i -D cross-env</code>
安装成功后配置构建命令:</p> <ul><li>在<code>package.json</code>的<code>scripts</code>中添加如下命令：</li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cross-env NODE_ENV=prod webpack --config config/webpack.config.prod.js&quot;</span><span class="token punctuation">,</span>
<span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cross-env NODE_ENV=dev nodemon --exec babel-node --inspect src/app.js&quot;</span><span class="token punctuation">,</span>
</code></pre></div></blockquote></li> <li><p>启动开发环境服务</p></li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">npm</span> run dev
</code></pre></div><p>运行之后的效果图如下：</p> <p><img src="/notes-page/assets/img/image-20210504095318351.4860df63.png" alt="image-20210504095318351"></p> <ul><li>启动编译构建命令</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">npm</span> run build
</code></pre></div><p>运行效果如下图：</p> <p><img src="/notes-page/assets/img/image-20210504095540666.8b5ae3f8.png" alt="image-20210504095540666"></p> <p>查看 dist 文件夹下被编译后的文件：</p> <p><img src="/notes-page/assets/img/image-20210504095736714.e22b4743.png" alt="image-20210504095736714"></p> <blockquote><p>被压缩成了一整行！</p></blockquote> <h2 id="路由自动注册"><a href="#路由自动注册" class="header-anchor">#</a> 路由自动注册</h2> <h3 id="使用require-directory"><a href="#使用require-directory" class="header-anchor">#</a> 使用require-directory</h3> <blockquote><p>在 src 文件夹下新建 routes 和 api 两文件夹；routes 是集成当前项目的所有路由，api 文件是存放项目的所有接口文件。</p></blockquote> <ul><li><p>安装 <a href="https://github.com/troygoode/node-require-directory/" target="_blank" rel="noopener noreferrer"><code>require-directory</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，这个包的作用可以将一个目录下的所有模块文件</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">npm</span> i require-dirctory
</code></pre></div></li> <li><p>创建<code>src/api/v1</code>下创建<code>demo.js</code>和<code>test.js</code>文件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/api/v1/demo.js</span>
<span class="token keyword">import</span> Router <span class="token keyword">from</span> <span class="token string">'@koa/router'</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">prefix</span><span class="token operator">:</span> <span class="token string">'/api/v1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/demo'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'message'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">file</span><span class="token operator">:</span> <span class="token string">'demo.js'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'webpack 5 构建node应用'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">'koa + @koa/router + require-dirctory'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//  src/api/v1/test.js</span>
<span class="token keyword">import</span> Router <span class="token keyword">from</span> <span class="token string">'@koa/router'</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">prefix</span><span class="token operator">:</span> <span class="token string">'/api/v1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/test'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'message'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">file</span><span class="token operator">:</span> <span class="token string">'test.js'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'webpack 5 构建node应用'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">'koa + @koa/router + require-dirctory'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router
</code></pre></div></li> <li><p>配置<code>src/routes/index.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Router <span class="token keyword">from</span> <span class="token string">'@koa/router'</span>
<span class="token keyword">import</span> requireDirectory <span class="token keyword">from</span> <span class="token string">'require-directory'</span>

<span class="token comment">// 接口存放目录路径</span>
<span class="token keyword">const</span> apiDirectory <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/src/api</span><span class="token template-punctuation string">`</span></span>

<span class="token keyword">function</span> <span class="token function">initLoadRoutes</span><span class="token punctuation">(</span><span class="token parameter">app</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">requireDirectory</span><span class="token punctuation">(</span>module<span class="token punctuation">,</span> apiDirectory<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function">visit</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> <span class="token keyword">default</span><span class="token operator">:</span> router <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>router <span class="token keyword">instanceof</span> <span class="token class-name">Router</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">.</span><span class="token function">routes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> initLoadRoutes
</code></pre></div></li> <li><p>修改<code>src/app.js</code>文件</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> Koa <span class="token keyword">from</span> <span class="token string">'koa'</span>
<span class="token keyword">import</span> initLoadRoutes <span class="token keyword">from</span> <span class="token string">'./routes/index'</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 在入口文件中执行</span>
<span class="token function">initLoadRoutes</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span>

<span class="token keyword">const</span> port <span class="token operator">=</span> <span class="token number">3002</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">服务启动在</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">端口</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>在 postman 中测试请求如下图</p> <p><img src="/notes-page/assets/img/image-20210504125524850.b5fb774a.png" alt="image-20210504125524850"></p> <p><img src="/notes-page/assets/img/image-20210504125437662.75866bf7.png" alt="image-20210504125437662"></p> <p>到此自动注册路由就大功告成了，后面我们定义接口的时候就用手动一个一个的引入，只管往 api 文件夹里写接口就好了。</p></li></ul> <h3 id="使用require-context-webpack-功能"><a href="#使用require-context-webpack-功能" class="header-anchor">#</a> 使用require.context（webpack）功能</h3> <p>官方文档：<a href="https://webpack.docschina.org/guides/dependency-management/" target="_blank" rel="noopener noreferrer">require<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>举例：</p> <div class="language- extra-class"><pre class="language-text"><code>.
├── modules
│   ├── adminRouter.js
│   ├── commentsRouter.js
│   ├── contentRouter.js
│   ├── loginRouter.js
│   ├── publicRouter.js
│   ├── userRouter.js
│   └── wxRouter.js
└── routes.js
</code></pre></div><p>目标：使用<code>routes.js</code>来动态加载<code>modules</code>目录中的<code>.js</code>的路由文件，其他的比如：<code>vuex</code>、<code>vue-router</code>等场景，都适合。</p> <p>先上实现出来的代码：</p> <p><code>routes.js</code>文件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> combineRoutes <span class="token keyword">from</span> <span class="token string">'koa-combine-routers'</span>

<span class="token comment">// 加载目录中的Router中间件</span>
<span class="token keyword">const</span> moduleFiles <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'./modules'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>

<span class="token comment">// reduce方法去拼接 koa-combine-router所需的数据结构 Object[]</span>
<span class="token keyword">const</span> modules <span class="token operator">=</span> moduleFiles<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">items<span class="token punctuation">,</span> path</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token function">moduleFiles</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>
  items<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span>default<span class="token punctuation">)</span>
  <span class="token keyword">return</span> items
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">combineRoutes</span><span class="token punctuation">(</span>modules<span class="token punctuation">)</span>
</code></pre></div><p>使用方法，在<code>index.js</code>入口文件中：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'./routes/routes'</span>


app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>这里有两个知识点：</p> <ol><li><p>使用<code>koa-combine-routers</code>可以合并多个路由</p></li> <li><p>使用<code>require.context</code>可以动态引入多个文件</p> <p><img src="/notes-page/assets/img/image-20210612192129199.30075345.png" alt="image-20210612192129199"></p> <p>说明：</p> <ul><li><p>require.context返回的是一个函数</p></li> <li><p>这个函数的键值，正是文件</p> <div class="language- extra-class"><pre class="language-text"><code>moduleFiles.keys()
(14) ['./adminRouter.js', './commentsRouter.js', './contentRouter.js', './loginRouter.js', './publicRouter.js', './userRouter.js', './wxRouter.js', 'routes/modules/adminRouter.js', 'routes/modules/commentsRouter.js', 'routes/modules/contentRouter.js', 'routes/modules/loginRouter.js', 'routes/modules/publicRouter.js', 'routes/modules/userRouter.js', 'routes/modules/wxRouter.js']
</code></pre></div></li> <li><p>这个函数接收文件名后，可以返回文件的内容，这个内容正好匹配路由，输出一个数组，传递给conbineRoutes方法，即可合并。</p> <div class="language- extra-class"><pre class="language-text"><code>const value = moduleFiles(path)
</code></pre></div><p><img src="/notes-page/assets/img/image-20210612192350748.1bc30e21.png" alt="image-20210612192350748"></p></li></ul></li></ol> <h2 id="配置别名"><a href="#配置别名" class="header-anchor">#</a> 配置别名</h2> <p>在日常开发中我们引入一些封装好的方法或者模块总是写很长很长的文件路径；比如：<code>require('../../../../some/very/deep/module')</code>、<code>import format from '../../../../utils/format'</code>，为了告别这种又臭又长的路径我们就可以使用一些解放生产力的方法了（哈哈哈哈，不会偷懒的程序员不是好程序员 🤭）</p> <p>配置别名有两种方式，一种是 webpack，另一种是通过<a href="https://www.npmjs.com/package/module-alias" target="_blank" rel="noopener noreferrer"><code>module-alias</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>包</p> <h3 id="使用webpack的别名功能"><a href="#使用webpack的别名功能" class="header-anchor">#</a> 使用webpack的别名功能</h3> <p>官方文档： <a href="https://webpack.docschina.org/configuration/resolve/" target="_blank" rel="noopener noreferrer">resolve.alias<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>配置方式，非常的简单方便：</p> <div class="language- extra-class"><pre class="language-text"><code>const path = require('path');

module.exports = {
  //...
  resolve: {
    alias: {
      '@': path.resolve(__dirname, 'src/'),
      // ...
    },
  },
};
</code></pre></div><h3 id="使用module-alias"><a href="#使用module-alias" class="header-anchor">#</a> 使用module-alias</h3> <ul><li><p>安装依赖</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">npm</span> i module-alias
</code></pre></div></li> <li><p>在<code>package.json</code>中添加自定义别名</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;_moduleAliases&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;@&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./src&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@controller&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./src/controller&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="/notes-page/assets/img/image-20210504141154503.7e1ea32c.png" alt="image-20210504141154503"></p></li> <li><p>在入口文件的顶部引入<code>module-alias/register</code>，也就是在<code>app.js</code>的顶部引入</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'module-alias/register'</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="/notes-page/assets/img/image-20210504142411612.3ddee265.png" alt="image-20210504142411612"></p></li></ul> <blockquote><p>配置成功后，将<code>/src/api/v1</code>内的逻辑全部提到<code>src/controller</code>中，使用别名引入<code>controller</code>中文件，修改后如下：</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/api/v1/demo.js</span>
<span class="token keyword">import</span> Router <span class="token keyword">from</span> <span class="token string">'@koa/router'</span>
<span class="token keyword">import</span> DemoController <span class="token keyword">from</span> <span class="token string">'@controller/demo/'</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">prefix</span><span class="token operator">:</span> <span class="token string">'/api/v1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/demo'</span><span class="token punctuation">,</span> DemoController<span class="token punctuation">.</span>demo<span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/api/v1/test.js</span>
<span class="token keyword">import</span> Router <span class="token keyword">from</span> <span class="token string">'@koa/router'</span>
<span class="token keyword">import</span> TestController <span class="token keyword">from</span> <span class="token string">'@controller/test'</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Router</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">prefix</span><span class="token operator">:</span> <span class="token string">'/api/v1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/test'</span><span class="token punctuation">,</span> TestController<span class="token punctuation">.</span>test<span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/controller/v1/demo.js</span>
<span class="token keyword">class</span> <span class="token class-name">DemoController</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">demo</span><span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'message'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">file</span><span class="token operator">:</span> <span class="token string">'test.js'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'webpack 5 构建node应用'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">'koa + @koa/router + require-dirctory'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">DemoController</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/controller/v1/test.js</span>
<span class="token keyword">class</span> <span class="token class-name">TestController</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'message'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">file</span><span class="token operator">:</span> <span class="token string">'test.js'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'webpack 5 构建node应用'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">'koa + @koa/router + require-dirctory'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">TestController</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><p>postman 中测试接口</p> <p><img src="/notes-page/assets/img/image-20210504143159248.375ecc14.png" alt="image-20210504143159248"></p> <p><img src="/notes-page/assets/img/image-20210504143225351.f93228ef.png" alt="image-20210504143225351"></p></li></ul> <p>commit 时 lint-staged 没有通过：</p> <p><img src="/notes-page/assets/img/image-20210504152231237.333b1077.png" alt="image-20210504152231237"></p> <blockquote><p>上述问题是 eslint 发现<code>@controller/*</code>开头的在 node_modules 中没有找到，所以配置 eslint 就好了：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/eslintrc.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">'import/no-unresolved'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">ignore</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'^@/'</span><span class="token punctuation">,</span> <span class="token string">'@controller'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token comment">// @和@controller 是设置的路径别名</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></blockquote> <p><img src="data:image/png;base64,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" alt="image-20210504154049823"></p> <blockquote><p>这个问题是由于<code>constructor</code>构造函数为空引起的，在<code>eslintrc.js</code>添加配置即可：'no-empty-function': ['error', { allow: ['constructors'] }]</p></blockquote> <p>完整代码见：<a href="https://github.com/big-front-end/webpack5-node" target="_blank" rel="noopener noreferrer">GitHub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <!----> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/notes-page/basic/node/01-koa.html" class="prev">
        Koa(下一代web框架)
      </a></span> <span class="next"><a href="/notes-page/basic/node/03-项目规范及工具.html">
        项目规范及工具
      </a>
      →
    </span></p></div>  <div class="el-dialog__wrapper" style="display:none;"><div role="dialog" aria-modal="true" aria-label="dialog" class="el-dialog" style="margin-top:15vh;width:420px;"><div class="el-dialog__header"><span class="el-dialog__title"></span><button type="button" aria-label="Close" class="el-dialog__headerbtn"><i class="el-dialog__close el-icon el-icon-close"></i></button></div><!----><div class="el-dialog__footer"><span class="dialog-footer"><button type="button" class="el-button el-button--default"><!----><!----><span>取 消</span></button> <button type="button" class="el-button el-button--primary"><!----><!----><span>确 定</span></button></span></div></div></div></main> <!----></div><div class="global-ui"><!----><div tabindex="-1" role="dialog" aria-hidden="true" class="pswp"><div class="pswp__bg"></div> <div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div> <div class="pswp__item"></div> <div class="pswp__item"></div></div> <div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div> <button class="pswp__button pswp__button--close"></button> <button class="pswp__button pswp__button--share"></button> <button class="pswp__button pswp__button--fs"></button> <button class="pswp__button pswp__button--zoom"></button> <div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div> <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div> <button class="pswp__button pswp__button--arrow--left"></button> <button class="pswp__button pswp__button--arrow--right"></button> <div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div></div></div>
    <script src="/notes-page/assets/js/app.57fa022d.js" defer></script><script src="/notes-page/assets/js/8.4c2d1a00.js" defer></script><script src="/notes-page/assets/js/13.72e91839.js" defer></script>
  </body>
</html>
