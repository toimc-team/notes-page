(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{1014:function(e,t,s){"use strict";s(358)},1030:function(e,t,s){"use strict";s.r(t);s(991),s(995),s(998),s(999),s(1002),s(1004),s(1006),s(1010);var a=s(39),i=s(70),c=s(1021),r=s(1013),o=s.n(r),n={data:()=>({expire:!1,src:"",date:"",ctrl:parseInt(localStorage.getItem("ctrl"))||""}),mounted(){clearInterval(this.ctrl)},watch:{show(e){e&&this.getImg()}},computed:{...Object(a.e)({show:e=>e.qrcodeShow})},methods:{async getImg(){clearInterval(this.ctrl);const e=localStorage.getItem("scene");e?this.scene=e:(this.scene=Object(c.a)(),localStorage.setItem("scene",this.scene)),this.expire=!1;const t=await Object(i.b)({scene:this.scene}),s=new Uint8Array(t);let a="";const r=s.byteLength;for(let e=0;e<r;e++)a+=String.fromCharCode(s[e]);this.src="data:image/png;base64,"+window.btoa(a),this.date=new Date,this.checkLogin()},checkLogin(){this.ctrl=setInterval(async()=>{const e=await Object(i.e)({scene:this.scene});200===e.code&&e.data&&e.data.username&&(this.$store.commit("setUserInfo",e.data),this.$store.commit("setToken",e.token),this.$store.commit("setRefreshToken",e.refreshToken),this.hide());Math.abs(o()(this.date).diff(o()()))>12e4&&(clearInterval(this.ctrl),this.expire=!0)},2e3),localStorage.setItem("ctrl",this.ctrl)},hide(){clearInterval(this.ctrl),this.$store.commit("setCodeShow",!1)}}},l=(s(1014),s(11)),h=Object(l.a)(n,(function(){var e=this,t=e._self._c;return e.show?t("div",{on:{click:e.hide}},[t("div",{staticClass:"wrapper"},[t("div",{staticClass:"info"},[e._v("打开微信扫一扫")]),e._v(" "),t("div",{staticClass:"box"},[t("div",{staticClass:"qrcode"},[t("img",{directives:[{name:"show",rawName:"v-show",value:e.src,expression:"src"}],staticClass:"box-img",attrs:{src:e.src,alt:"qrcode"}}),e._v(" "),e.expire?t("div",{staticClass:"tips-mask"},[t("p",[e._v("小程序二维码状态已过期")])]):e._e()]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.expire,expression:"expire"}],staticClass:"resend",on:{click:function(t){return t.stopPropagation(),e.getImg.apply(null,arguments)}}},[e._v("重新获取二维码")])])]),e._v(" "),t("div",{staticClass:"mask"})]):e._e()}),[],!1,null,"1fb1386a",null);t.default=h.exports},358:function(e,t,s){}}]);